<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2007-2009 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Raytracing with POV-Ray</TITLE>
</head>
<body>
<h2>Raytracing with POV-Ray</h2>

<table align="right" border="1" style="margin:8px 8px 8px 8px">
<tr><td>
<img src="nucfig.png" alt="1x95 Nucleotides example">
</td></tr>
</table>
<p>
The <a href="http://www.povray.org"
target="_blank">Persistence of Vision Raytracer</a> (POV-Ray)
is included with Chimera.  POV-Ray images can be saved:
<ul>
<li>with <a href="print.html"><b>Save Image</b></a>
<li>with the <a href="midas/copy.html"><b>copy</b></a> command
<li>when <a href="movies.html">making movies</a>
</ul>
Raytraced images can only be saved in the PNG format.
For each raytraced image, Chimera first generates two POV-Ray input files:
<ul>
<li> scene description (*.pov file)
<li> raytracing options (*.ini file)
</ul>
The raytracing calculation is then run as a background job 
that can be monitored or canceled using the
<a href="../ContributedSoftware/idle/task.html"><b>Task Panel</b></a>.
Several raytracing parameters can be set in the
<a href="preferences.html#POV-Ray Options"><b>POV-Ray Options</b> 
preferences</a>.
</p><p>
See also: 
<a href="export.html">exporting a scene</a>,
<a href="print.html#tips">tips on preparing images</a>
</p>

<h3>Lights and Shadows</h3>
<p>
Chimera includes two <a href="sideview.html#lighting">light sources</a>,
<b><i>key</i></b> (dominant) and <b><i>fill</i></b> (secondary).  
Their directions and intensities can be adjusted in the
<a href="sideview.html#lighting"><b>Lighting</b> tool</a> 
and are propogated to POV-Ray for raytracing.
By default, only the key light produces shiny highlights and shadows.
Decreasing the <a href="sideview.html#lighting"><b>key-to-fill ratio</b></a>
will decrease the contrast between shadows and unshadowed regions.
</p><p>
Interactive shadowing in Chimera (the 
<a href="sideview.html#shadows"><b>show shadows</b></a> setting in
<a href="sideview.html#effects"><b>Effects</b></a>) can be used to
preview where shadows will fall.
</p>

<a name="speedup">
<h3>Balancing Time Requirements and Results</h3></a>
<p>
Sometimes a considerable speedup in raytracing can be obtained with 
little change in output appearance by adjusting settings in the
<a href="preferences.html#POV-Ray Options"><b>POV-Ray Options</b> 
preferences</a>.  This is particularly true for
<a href="movies.html">movies</a>, 
which are compressed to some extent during encoding.
Changes to consider include:
<ul>
<li>decreasing the
<a href="preferences.html#POV-Ray Options"><b>quality</b></a> to 4 or 5
[<a href="http://www.povray.org/documentation/view/3.6.1/223/#s02_01_02_08_01"
target="_blank">quality details</a> at the POV-Ray site]
<li>increasing the
<a href="preferences.html#POV-Ray Options"><b>antialias threshold</b></a>
to 1.5 or even higher (maximum 3.0)
[<a href="http://www.povray.org/documentation/view/3.6.1/223/#s02_01_02_08_04"
target="_blank">antialias details</a> at the POV-Ray site]
<li>if objects are not intentionally sliced, making sure that
<a href="clipping.html#global">global clipping</a> is turned off;
to adjust depth cueing, use the <b>start</b> and <b>end</b> parameters in
<a href="sideview.html#effects"><b>Effects</b></a>
rather than moving the global clipping planes, which would turn clipping on
</ul>
There is no single answer as to which values will optimally balance
time requirements and results, as it will depend on the contents of the
scene, the available computational power, and the patience of the user.
Running a few tests is recommended before committing to raytracing
a large set of images with a particular set of parameters.
</p><p>
Raytracing jobs can be monitored and canceled using the
<a href="../ContributedSoftware/idle/task.html"><b>Task Panel</b></a>.
</p>

<a name="limitations">
<h3>Limitations</h3></a>
<p>
Using transparency or <a href="clipping.html">clipping</a> 
may increase rendering time significantly.
</p><p>
A raytraced image from POV-Ray may differ from the view in Chimera 
in several ways.  Some differences are desirable, such as the presence 
of shadows.  Others reflect current limitations of the POV-Ray format 
and/or its implementation in Chimera:
</p>
<ul>
<li>colors may differ slightly
<li>shading along <a href="representation.html#ribbon">ribbons</a>
may be stairstepped; using the <b>supersmooth</b> style instead of 
<b>rounded</b> reduces this effect
<li><a href="sideview.html#lighting">light source</a> directions but not
colors are translated from Chimera
<li>although object 
<a href="sideview.html#shininess">shininess and brightness</a> levels 
(but not specular color) are translated from Chimera, objects tend 
to appear shinier in the raytraced image (perhaps a desired effect)
<li>if <a href="sideview.html#effects">depth cueing</a> is used,
the background of the raytraced image: 
  <ul>
  <li>will not be transparent even if the
  <a href="preferences.html#POV-Ray Options">transparent background</a>
  option is turned on
  <li>will match the <a href="sideview.html#effects">depth-cueing</a> color
  even if the background is a different color in Chimera
  </ul>
<li>the following are omitted or otherwise not handled:
<a href="sideview.html#silhouette">silhouettes</a>,
<a href="preferences.html#Background">selection highlighting</a>,
<a href="stereo.html">stereo</a>,
<a href="../ContributedSoftware/volumeviewer/framevolumeviewer.html" 
target="_top"><b>Volume Viewer</b></a> transparent solid displays,
and normals on dot and mesh surfaces
<li><b>max_trace_level</b> is set to 10 to improve multi-level transparency,
but this also increases time and memory requirements relative to lower levels
[<a href="http://www.povray.org/documentation/view/3.6.1/264/"
target="_blank">details</a> at the POV-Ray site]
</ul>
<hr>
<address>UCSF Computer Graphics Laboratory / August 2009</address>
</body></html>
