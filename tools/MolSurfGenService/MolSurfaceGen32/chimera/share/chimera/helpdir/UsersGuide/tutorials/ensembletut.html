<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2002-2009 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html><head>
<title>The Model Panel and Ensembles Tutorial</title>
</head><body>
<font size="-1">
<a href="../frametut.html" target="_top">Chimera Tutorials Index</a>
</font>

<h2>The Model Panel and Ensembles Tutorial</h2>
<p>
This tutorial focuses on using the 
<a href="../modelpanel.html"><b>Model Panel</b></a>
and handling ensembles of structures (such as those determined by NMR).
</p><p>
We will view solution structures of a toxin that binds to sodium channels.
Separate ensembles were determined for <i>cis</i>- and <i>trans</i>-proline 
conformations of this toxin:
<blockquote><a name="reference">
<a href="http://www.ncbi.nlm.nih.gov/pubmed/14976206" target="_blank">
NMR solution structures of &delta;-conotoxin EVIA from <i>Conus ermineus</i>
that selectively acts on vertebrate neuronal Na+ channels.</a>
Volpon L, Lamthanh H, Barbier J, Gilles N, Molg&oacute; J, M&eacute;nez A, 
Lancelin JM.
<i>J Biol Chem.</i> 2004 May 14;279(20):21356-66.
</a></blockquote>
On <b>Windows</b>/<b>Mac</b>, click the <b>chimera</b> icon;
on <b>UNIX</b>, start Chimera from the system prompt:
<blockquote><tt>
<i>unix</i>: <b>chimera</b>
</tt></blockquote>
A basic Chimera window should appear after a few seconds; resize it as desired.
Open the <a href="../chimerawindow.html#emulator"><b>Command Line</b></a>
(choosing <b>Tools... General Controls... Command Line</b> is one way).
</p><p>
If you have internet connectivity, structures can be obtained directly from the
<a href="http://www.rcsb.org" target="_blank">Protein Data Bank</a>:
<blockquote>
<i>Command</i>: <b><a href="../midas/open.html">open</a> 1g1p</b>
<br>
<i>Command</i>: <b><a href="../midas/open.html">open</a> 1g1z</b>
</blockquote>
If you do not have internet connectivity, 
you can <a href="download.html">download</a> the files
<a href="1g1p.pdb.gz">1g1p.pdb.gz</a> and
<a href="1g1z.pdb.gz">1g1z.pdb.gz</a>
into your working directory and then open them in that order
as local files (with <b>File... Open</b>).  
It is not necessary to uncompress the files.
</p><p>
Use the ribbons <a href="../menu.html#menupresets">preset</a>:
<blockquote>
<i>Menu</i>:&nbsp;<b>Presets... Interactive 1 (ribbons)</b>
</blockquote>
This may or may not change the appearance, depending on your 
preference settings.
</p><p>
<a href="../mouse.html">Rotate, translate, and scale</a> the structures
as desired throughout the tutorial.  Optionally, use
the <a href="../sideview.html#sideview"><b>Side View</b></a>
to scale the view and move the front and back clipping planes.  
There are <a href="../extension.html">several ways</a>
to start tools, including from the menu
(in this case, <b>Tools... Viewing Controls... Side View</b>) 
or with a command: 
<blockquote>
<i>Command</i>: <b><a href="../midas/start.html">start</a> Side View</b>
</blockquote>
</p><p>
Open the <a href="../modelpanel.html"><b>Model Panel</b></a>:
<blockquote>
<i>Command</i>: <b><a href="../midas/start.html">start</a> Model Panel</b>
</blockquote>
Each file of coordinates opened in Chimera becomes a <b><i>model</i></b>
with an associated ID number and <a href="../hierarchy.html">model color</a>.
Some PDB files are further subdivided into multiple structures
designated with <tt>MODEL</tt> and <tt>ENDMDL</tt> records;  
these are assigned <b><i>submodel</b></i> numbers.  Each structure
can be specified independently by number (<b>model.submodel</b>)
and handled just as if it were a separate model.
Thus, the term "model" often indicates anything with its own line in
the <b>Model Panel</b>, whether it is a submodel or a model 
not subdivided into submodels.
</p>
<table border="1" align="right" style="margin:8px 8px 8px 12px">
<tr><td><img src="modpaninit.png"></td></tr>
</table>
<p>
Each of these files contains an ensemble of 18 structures.
<b>1g1p</b> (<i>trans</i>-proline conformations, white) 
has been opened as models 0.1-0.18
and <b>1g1z</b> (<i>cis</i>-proline conformations, magenta) 
as models 1.1-1.18.  
</p><p>
At first, most of the
<a href="../modelpanel.html#functions">functions</a> on the right 
side of the <b>Model Panel</b> are grayed out because none of the models
are chosen.  Scroll down the list of models in the left side of the 
<b>Model Panel</b> and <a name="chosen">choose model <b>1.2</b></a> 
by clicking its ID or name.  Try various functions:
<blockquote>
 <b>show only</b> - hide the other models
 <br><b>show all atoms</b> - display all atoms
 <br><b>select</b> - <a href="../selection.html">select</a> the entire model
  for further operations
</blockquote>
By default, ribbons suppress backbone atom display.  Hide the ribbon
to reveal the backbone atoms:
<blockquote>
<i>Menu</i>:&nbsp;<b>Actions... Ribbon... hide</b>
</blockquote>
Select and delete hydrogens in <i>all</i> models:
<blockquote>
<i>Menu</i>:&nbsp;<b>Select... Chemistry... element... H</b>
<br>
<i>Menu</i>:&nbsp;<b>Actions... Atoms/Bonds... delete</b>
</blockquote>
When atoms might be needed later, <b>hide</b> should be used
instead of <b>delete</b>.
</p><p>
Back to the <b>Model Panel</b>:
<blockquote>
<b>sequence...</b> opens a 
<a href="../../ContributedSoftware/multalignviewer/framemav.html"
target="_top">sequence window</a> for the model.
Two very short &beta;-strands (positions 24-25 and 29-30) 
are highlighted in light green.  Placing the mouse cursor over a residue
in the sequence shows the corresponding structure residue number
at the bottom of the sequence window.  The &beta;-strand locations 
were read from the input file along with the coordinates.
Highlight a string of residues in the sequence with the mouse
and see how they become <a href="../selection.html">selected</a>
in the structure.  <b>Quit</b> from the sequence window, 
then act on the selection with the menu:
<b>Actions... Color... cyan</b>
</blockquote>
Clear the selection (Ctrl-click in an empty area of the graphics window) 
and go back to showing only ribbons:
<blockquote>
<i>Menu</i>:&nbsp;<b>Presets... Interactive 1 (ribbons)</b>
</blockquote>
Note the cyan coloring is gone; 
<a href="../menu.html#menupresets">interactive presets</a> reset the coloring,
whereas <a href="../menu.html#menupresets">publication presets</a>
do not adjust colors, aside from making the background white.
</p><p>
The ribbon shows the &beta;-strands as arrows.  
Although the input file specifies the strand locations as 24-25 and 29-30, 
the <a href="#reference">paper</a>
describes three &beta;-strands, comprised of residues 8-10, 23-26, and 28-31.
Such differences are common because secondary structure assignments are
method- and parameter-dependent.  Secondary structure assignments could
be recomputed with <a href="../midas/ksdssp.html"><b>ksdssp</b></a>,
but if the desired assignments are already known, it is much more efficient
to change them directly:
<blockquote>
<i>Command</i>: <b><a href="../midas/setattr.html">setattr</a> r isStrand false</b>
<br> 
<i>Command</i>: <b><a href="../midas/setattr.html">setattr</a> r isStrand true :8-10,23-26,28-31</b>
</blockquote>
These commands assign values of the
<a href="../midas/atom_spec.html#resprops">residue attribute</a> named 
<b>isStrand</b>. The first command clears existing strand assignments, and 
the second reassigns the strands as reported in the paper.
(There is also an <b>isHelix</b> attribute, but this
structure does not contain any &alpha;-helices).
Secondary structure assignments can also be changed by
<a href="../selection.html">selecting</a> residues and using the
<a href="../inspection.html"><b>Selection Inspector</b></a>.
</p><p>
The strands can be emphasized with color:
<blockquote>
<i>Command</i>: <b><a href="../midas/color.html">color</a> blue #1.2</b>
<br>
<i>Command</i>: <b><a href="../midas/color.html">color</a> yellow #1.2 & strand</b>
</blockquote>
(There is also a 
<a href="../../ContributedSoftware/colorss/colorss.html"><b>Color
Secondary Structure</b></a> tool for those who prefer a graphical interface.)
</p><p>
<a name="hideshow">
In the <b>Model Panel</b>, the <b>S</b> (<b>Shown</b>) checkboxes</a> toggle
<a href="../hierarchy.html#displevels">model display</a> without changing 
the display settings of individual atoms, bonds, and ribbon segments.
<blockquote>
uncheck the <b>S</b> box for model 1.2
<br><br>
check the <b>S</b> box for model 1.2
</blockquote>
The <b><a href="../midas/modeldisplay.html">modeldisplay</a></b> command
does the same thing.  Show all of the models:
<blockquote>
<i>Command</i>: <b><a href="../midas/modeldisplay.html">modeldisp</a></b>
</blockquote>
The <b>A</b> (<b>Active</b>) checkboxes in the <b>Model Panel</b>
control what can be moved:
<blockquote>
uncheck the <b>A</b> box for model 1.2 and try moving the structures
<a href="../mouse.html">with the mouse</a>; now only the other models can be 
rotated and translated
<br><br>
check the <b>A</b> box for model 1.2 and try moving the structures
again
</blockquote>
Reset to the original model positions:
<blockquote>
<i>Command</i>: <b><a href="../midas/reset.html">reset</a></b>
</blockquote>
We will use
<a href="../../ContributedSoftware/ensemblecluster/ensemblecluster.html">
<b>Ensemble Cluster</b></a> to cluster each ensemble and
identify representative structures, then use
<a href="../../ContributedSoftware/ensemblematch/ensemblematch.html">
<b>Ensemble Match</b></a> to compare the representatives.
</p><p>
Start <a href="../../ContributedSoftware/ensemblecluster/ensemblecluster.html">
<b>Ensemble Cluster</b></a> (under <b>Tools... MD/Ensemble Analysis</b>)
and choose <b>1g1p</b> as the ensemble to cluster.  Leave the <b>Parts
to Match</b> blank to use all atoms and click <b>OK</b>.  
Results are shown in a cluster list dialog; three clusters were found.
In that dialog,
<blockquote>
click the black arrowhead to reveal the <b>Treatment of Chosen Clusters</b>
<br><br>
choose all three cluster lines in the dialog with the mouse;
this recolors all the <b>1g1p</b> structures,
using three different colors for the three clusters,
and chooses their lines in the <b>Model Panel</b>
<br><br>
change the third <b>Treatment</b> option to choose only
the <b>representatives</b> in the <b>Model Panel</b>
</blockquote>
In the right side of the <b>Model Panel</b>, click <b>show only</b>.  
Now only three structures are shown in the graphics window,
the representatives of the three clusters of <b>1g1p</b>.
<b>Quit</b> from the cluster dialog, then
delete the undisplayed members of the <b>1g1p</b> ensemble:
<blockquote>
<i>Command</i>: <b><a href="../midas/delete.html">delete</a> #0/!display</b>
</blockquote>
This deletes models with ID number 0 and model display turned off.
</p><p>
Start <a href="../../ContributedSoftware/ensemblecluster/ensemblecluster.html">
<b>Ensemble Cluster</b></a> again and cluster <b>1g1z</b> using all atoms.
This time, four clusters are found.  
In the cluster dialog, make sure the treatment is to choose only 
<b>representatives</b> in the <b>Model Panel</b>.  Choose just
the two clusters with more than one structure and then, as before,
click <b>show only</b> in the <b>Model Panel</b>.
<b>Quit</b> from the cluster dialog and delete the rest of the 
<b>1g1z</b> ensemble:
<blockquote>
<i>Command</i>: <b><a href="../midas/delete.html">delete</a> #1/!display</b>
</blockquote>
In the left side of the <b>Model Panel</b>,
drag with the mouse to choose all five remaining models.
On the right side,
<blockquote>
click <b>show only</b> to show all five models
<br><br>
click <b>rainbow...</b> and in the resulting dialog, click <b>OK</b>
to give each <b>model</b> a different color in the rainbow range
<br><br>
click <b>tile...</b> and in the resulting dialog, adjust <b>Border scale</b>
to 0.8 and click <b>OK</b> to spread the models out in a plane
</blockquote>
Finally, compare the structures with
<a href="../../ContributedSoftware/ensemblematch/ensemblematch.html">
<b>Ensemble Match</b></a> (under <b>Tools... MD/Ensemble Analysis</b>).
Choose one ensemble as the reference and the other as the alternative.  
For <b>Parts to Match</b> just 
<a href="../midas/atom_spec.html#basic">specify</a> the backbone atoms:
<blockquote>
<b>@n,ca,c,o</b>
</blockquote>
</p>
<table border="1" align="right" style="margin:8px 12px 8px 8px">
<tr><td><img src="enstut.png"></td></tr>
</table>
<p>
Click <b>OK</b> to calculate the matches.
Results are shown as a 3 x 2 (or 2 x 3) table with entries for all 
pairwise comparisons between the ensembles.
The <b>A</b> and <b>D</b> buttons control model 
<a href="../mouse.html#activedef">activation for motion</a> and
<a href="../hierarchy.html#displevels">model display</a>, respectively.
The numbers in the table are pairwise RMSDs using the atoms 
that were specified as <b>Parts to Match</b>.
</p><p>
The structures are not yet superimposed.  Clicking a button next to an
RMSD value performs the corresponding match and reports
in the <a href="../chimerawindow.html#statusline">status line</a>
the number of atom pairs used.
Superimpose each <i>cis</i>-proline conformation in model 1 on the 
most similar (lowest-RMSD) <i>trans</i>-proline conformation in model 0.
</p><p>
In this case, <i>cis</i> and <i>trans</i> refer to the peptide bond between
leucine-12 and proline-13.  Display these residues as ball-and-stick:
<blockquote>
<i>Command</i>: <b><a href="../midas/display.html">disp</a> :12-13</b>
<br>
<i>Command</i>: <b><a href="../midas/represent.html">repr</a> bs</b>
</blockquote>
When finished viewing the structures,
choose <b>File... Quit</b> from the menu to exit from Chimera.
</p>
<hr>
<address>meng-at-cgl.ucsf.edu / August 2009</address>
</body></html>
