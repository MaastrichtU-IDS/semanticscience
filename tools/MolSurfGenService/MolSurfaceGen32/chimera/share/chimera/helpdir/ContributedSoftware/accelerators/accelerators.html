<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2002-2008 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Keyboard Shortcuts</TITLE>
</head>
<body>
<h3>Keyboard Shortcuts 
<img src="accel.png" alt="icon">
</h3>
<p>
The <b>Keyboard Shortcuts</b> extension allows simple 
<a href="alist.html">keyboard shortcuts</a> (<b><i>accelerators</i></b>)
to be used for many operations in Chimera.  See also: 
<a href="../../UsersGuide/keys.html">general keyboard shortcuts</a>
</p><p>
Use of these shortcuts is disabled by default, but can be turned on:
<ul>
<li>with the command <a href="../../UsersGuide/midas/ac.html"><b>ac</b></a>
<li>by starting <b>Keyboard Shortcuts</b> (for example, with <b>Tools...
General Controls... Keyboard Shortcuts</b>) and 
turning on <b>Enable keyboard shortcuts</b> 
in the <a href="#dialog">dialog</a>
</ul>
The shortcut mode can be disabled:
<ul>
<li>with the <a href="alist.html">accelerator</a> <b>af</b>
<li>with the <a href="alist.html">accelerator</a> <b>cl</b>
(also shows the
<a href="../../UsersGuide/chimerawindow.html#emulator"><b>Command Line</b></a>)
<li>by turning off <b>Enable keyboard shortcuts</b>
in the <a href="#dialog">dialog</a>
</ul>
Checking/unchecking <b>Enable keyboard shortcuts</b> changes the
<a href="../../UsersGuide/preferences.html#preffile"><b>preferences</b> file</a>
to automatically enable/disable the shortcut mode when Chimera is next
started.  Other methods of turning accelerators on or off
do not alter the preferences.
</p><p>
<a href="alist.html">Many accelerators</a> are included with Chimera,
and more can be <a href="#adding">added</a>.
They usually consist of two characters,
but any number of characters is possible.  Uppercase letters are sometimes
used and are distinct from lowercase.
Several provide capabilities not accessible through the graphical interface.
Keyboard shortcuts are not entered in the 
<a href="../../UsersGuide/chimerawindow.html#emulator"><b>Command Line</b></a>
except via the command <a href="../../UsersGuide/midas/ac.html"><b>ac</b></a>.
</p>

<a name="dialog">
<h3>Keyboard Shortcuts Dialog</h3>
</a>
<table border="1" align="right" style="margin:8px 8px 8px 8px"> 
<tr><td>
<img src="accellist.png" alt="Keyboard Shortcuts dialog" align="right">
</td></tr>
</table>
<p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>Keyboard Shortcuts</b>, a tool in the <b>General Controls</b> category.
The resulting dialog lists the known accelerators along with brief 
descriptions.  Clicking on an entry in the list
shows a more detailed description (if available) at the bottom of the dialog.
<ul>
<li><b>Enable keyboard shortcuts</b> controls whether accelerators are enabled.
<a name="accstat">
<li><b>Show main window status line</b></a> controls whether a
<a href="../../UsersGuide/chimerawindow.html#statusline">status line</a>
is shown under the Chimera window.  Keystrokes interpreted as
accelerators and messages reporting their effects appear in the status line.
<li><b>Load shortcuts file</b> reads accelerator definitions from the
Python file whose pathname is shown in the field below.
New keyboard shortcuts can be <a href="#adding">added</a> by putting
their definitions in a Python file and then using <b>Load</b>.
<li><a name="timeout">
<b>Key press time-out (seconds)</b></a> (default <b>2</b>)
controls how long keystrokes that form part of an accelerator
are remembered.
</ul>
Settings in the dialog are saved in the 
<a href="../../UsersGuide/preferences.html#preffile">
<b>preferences</b> file</a>, except that the status of
<b>Enable keyboard shortcuts</b> is only saved 
when the option is manually checked/unchecked by the user.
</p>

<a name="conflict">
<h3>Accelerator or Command?</h3>
</a>
<p>
Keystrokes may be interpreted as accelerators, as commands, or
as information intended for other dialogs.
Sometimes it is necessary to click in the graphics window 
to take back focus from some other dialog so that
accelerator or command keystrokes will register.
</p><p>
An accelerator takes effect as soon as it is typed; there is no need
to press return (Enter). A command takes effect after return is pressed.
How these forms of input are distinguished:
<ul>
<li>If accelerators are on and the <b>Command Line</b> has not been shown,
keystrokes are interpreted as accelerators
when the mouse focus is in the graphics window.
<br><br>
<li>To allow both types of input, accelerators should be turned on
<i>after</i> the <b>Command Line</b> has been shown.
If the <b>Command Line</b> is started after accelerators,
it will receive all of the keystrokes, even if subsequently 
<a href="../../UsersGuide/instances.html">hidden or quit</a>.
In this situation, to enable both types of input:
  <ul>
  <li>turn or toggle accelerators on again 
  <li>use the <i>command</i> 
  <a href="../../UsersGuide/midas/ac.html"><b>ac</b></a> 
  </ul>
<br>
<li>When both types of input are enabled as described above,
one must click in the graphics window to indicate that keystrokes
should be interpreted as accelerators and click in the 
command-line area to indicate that keystrokes should be
interpreted as commands.
</ul>
The accelerator <b>hc</b> hides the <b>Command Line</b>
while the accelerator <b>cl</b> opens it and turns off accelerators.
</p>

<a name="errors">
<h3>Time-outs and Entry Errors</h3>
</a>
<p>
Keystrokes being interpreted as accelerators are shown in the
<a href="../../UsersGuide/chimerawindow.html#statusline">status line</a>;
the <a href="#timeout">time-out</a> setting
controls how long a partial accelerator entry is retained.
If the wrong key has been pressed, simply waiting
for the <a href="#timeout">time-out</a> period
to elapse allows a fresh start.  Alternatively,
pressing the escape key clears the partial accelerator from memory.
Finally, if no accelerator starts with the key that has been pressed,
an "unknown accelerator" status message results and the keystroke is
not retained.
Completed accelerator operations are reported in the
<a href="../../UsersGuide/chimerawindow.html#statusline">status line</a>
and <a href="../../UsersGuide/reply.html"><b>Reply Log</b></a>.
</p>

<a name="adding">
<h3>Adding Keyboard Shortcuts</h3>
</a>
<p>
The standard Chimera keyboard shortcuts are defined in
<blockquote>
share/Accelerators/standard_accelerators.py
</blockquote>
within the Chimera installation directory.  New accelerators can be added 
by writing their definitions in a Python file
and reading the file with <b>Load</b> on the
<a href="#dialog"><b>Keyboard Shortcuts</b> dialog</a>.
</p><p>
Example file:
</p>
<pre>
def register_accelerators():

  from Accelerators import standard_accelerators
  standard_accelerators.register_accelerators()

  from Accelerators import add_accelerator
  add_accelerator('ry', 'Rotate models about y axis', rotate_y)
  add_accelerator('rs', 'Stop model rotation', stop_rotation)

def rotate_y():
  'Spins models about the y axis'
  import Midas
  Midas.roll(axis = 'y')

def stop_rotation():
  'Stops spinning models'
  import Midas
  Midas.freeze()
</pre>
<p>
The register_accelerators() function is called by the Accelerators
extension.  The first two lines load the standard accelerators.
The next three lines
define accelerators <b>ry</b> and <b>rs</b> to spin the models about the Y axis
and to stop the spinning.  The routines that spin and stop the spinning
use the Chimera Midas module.  The comment strings in the add_accelerator
lines are the short descriptions that appear in the top part of the
<a href="#dialog"><b>Keyboard Shortcuts</b> dialog</a> and, 
when the accelerator operation is performed, in the status line;
the comment string within each function is the explanation shown
at the bottom of the <a href="#dialog"><b>Keyboard Shortcuts</b> dialog</a>
when the accelerator list entry is clicked.
</p><p>
Since accelerators take effect immediately (without return),
a new accelerator cannot start with an existing accelerator.
For example, if <b>ab</b> is a known accelerator, accelerators of the
form <b>ab<i>x</i></b>, where <b><i>x</i></b> is any character,
cannot be used.
</p>

<a name="limitations">
<h3>Limitations</h3>
</a>
<p>
<b>A click in the graphics window may be required.</b><br>
Sometimes it is necessary to click in the graphics window 
to take back focus from some other dialog so that
accelerator or command keystrokes will register.
</p><p>
<b>"Off by one" situations can occur.</b><br>
Suppose <b>sv</b> (open the <a href="../../UsersGuide/sideview.html#sideview">
<b>Side View</b></a>) is intended, but "xv" is typed accidentally.
If there is no accelerator starting with "x," an "unknown accelerator"
status message results and only the "v" is retained in memory.
If <b>sv</b> is then typed before the <a href="#timeout">time-out</a> period
has elapsed, the keystrokes will be interpreted as the accelerator
<b>vs</b> (show volume) and another "v" is retained in memory until
the <a href="#timeout">time-out</a> period has again elapsed
(or the escape key is pressed).
</p><p>
<b>Accelerators could be shown on menu entries.</b><br>
The keyboard shortcuts could be shown on the corresponding menu entries
to make them easier to learn.  More accelerators could be defined
so that they are available for all suitable menu entries.
</p>
<hr>
<address>UCSF Computer Graphics Laboratory / May 2008</address>
</body>
</html>
