<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2001-2009 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Volume Tracer</TITLE>

<style type="text/css">
A.nounder:link {text-decoration: none}
A.nounder:visited {text-decoration: none}
A.nounder:active {text-decoration: none}
A.nounder:hover {text-decoration: underline; color: red;}
</style>
</head>

<body>
<h3>Volume Tracer <img src="vpt.png" alt="Volume Tracer icon"></h3>
<p>
<img src="volume.png" align="right">
<b>Volume Tracer</b> allows interactive placement of markers within
<a href="../../UsersGuide/filetypes.html#volume">volume data</a>
displayed by <a href="../volumeviewer/framevolumeviewer.html" target="_top">
<b>Volume Viewer</b></a>.  The markers can be labeled and connected by smooth, 
interpolated paths, and paths can be stacked to form a surface. 
Markers can also be placed, moved, and connected in arbitrary ways
to build conceptual models independent of any volume data.
The state of <b>Volume Tracer</b> is included in saved 
<a href="../../UsersGuide/sessions.html#sesdef">sessions</a>.
See also: <a href="../volseries/volseries.html"><b>Volume Series</b></a>,
<a href="../../UsersGuide/midas/shape.html#tube"><b>shape tube</b></a>,
<a href="../../UsersGuide/midas/mask.html"><b>mask</b></a>,
<a href="../../UsersGuide/midas/meshmol.html"><b>meshmol</b></a>
</p><p>
This tool was initially designed to trace
fluorescently labeled chromosomes in light microscope data and
protein backbones in cryoelectron microscope density maps.
</p><p>
<a name="definitions">Definitions</a>:
<ul>
<li> A <b><i>marker</i></b> is a sphere with an associated position, radius,
and color, implemented in Chimera as an atom.
<li> A <b><i>marker note</i></b> is a text annotation associated with
a marker, implemented as an atom label.
<li> A <b><i>link</i></b> is a connection between markers, implemented 
as a bond and displayed as a cylinder with user-specified radius and color.
<li> A <b><i>marker set</i></b> is a named collection of markers
and links, implemented in Chimera as a molecule model.
<li> Multiple marker sets can be present, but only one at a time can be 
the <b><i>active set</i></b>.
The <a href="#markermenu"><b>Marker set menu</b></a> shows the 
name of the active set.
Various <a href="#menu">menu</a> operations apply to the active set, and
newly created markers and links are added to this set.
<li> A <b<i>marker file</i></b> includes marker set name(s), marker positions,
marker annotations, links, colors, and radii.
</ul>
</p><p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>Volume Tracer</b>, a tool in the <b>Volume Data</b> category
(including from the <a href="../volumeviewer/framevolumeviewer.html"
target="_top"><b>Volume Viewer</b></a> <b>Tools</b> menu).
</p>

<a name="organization">
<h4>VOLUME TRACER MENUS</h4></a>
</a>
<ul>
<li><a href="#filemenu"><b>File</b></a>
- read/save <a href="#markers">markers</a> and <a href="#links">links</a>
<li><a href="#actionsmenu"><b>Actions</b></a>
- hide/show/delete <a href="#markers">markers</a> and <a href="#links">links</a>
<li><a href="#mousemenu"><b>Mouse</b></a>
- control how <a href="#markers">markers</a> and <a href="#links">links</a>
are created and manipulated with the mouse
<li><a name="features"><b>Features</b> menu</a> 
- control which sections of the <b>Volume Tracer</b> dialog are shown
</ul>
<p>
<b>Volume Tracer</b> includes many options, usually not all shown at once.
Clicking a checkbox in the <b>Features</b> menu 
expands the dialog to show the corresponding section.  
A section can be closed by unchecking its entry in the <b>Features</b> menu,
unchecking its <a href="#fbuttons">feature button</a>, or
clicking its close button (<img src="../volumeviewer/x.png">), if present.
</p><p>
<table border="1" align="right" style="margin:8px 8px 8px 8px">
<tr><th align="center">Features menu<br>(default settings)</th></tr>
<tr><td><img src="defaultfeatures.png"></td></tr>
</table>
The figure shows the <a href="../../UsersGuide/menu.html#tear-off">torn-off</a>
<b>Features</b> menu with default settings:
<ul>
<li><a href="#fbuttons"><b>Feature buttons</b></a>
<li><a href="#markerprops"><b>Marker color and radius</b></a>
<li><a href="#markernotes"><b>Marker notes</b></a>
<li><a href="#markerlist"><b>Marker set list</b></a>
<li><a href="#markermenu"><b>Marker set menu</b></a>
<li><a href="#mousebutton"><b>Mouse button menu</b></a>
<li><a href="#mousemode"><b>Mouse mode options</b></a>
<li><a href="#rename"><b>Rename marker set</b></a>
<li><a href="#slice"><b>Slice display</b></a>
<li><a href="#smooth"><b>Smooth paths</b></a>
<li><a href="#surfaces"><b>Surfaces</b></a>
</ul>
<b>Show only default panels</b> restores the default state of the 
<b>Features</b> menu, and thus which sections are shown in the 
dialog.  
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="fbuttons">
<b>Feature buttons</b></a>
<p>
This section contains a row of small, unlabeled buttons
representing the <i>other</i> possible sections of
the <b>Volume Tracer</b> dialog. Checking a feature
button has the same effect as checking a box in the
<a href="#features"><b>Features</b> menu</a>.
Although arranged horizontally, the buttons are in the same order as the
menu entries. Placing the cursor over a feature button
shows the name of the feature.
</p>

<a name="markersets">
<h4>MARKER SETS</h4>
</a>
<p>
<a name="setdef">
A <b><i>marker set</i></b></a> is a named collection of 
<a href="#markers">markers</a> and <a href="#links">links</a>,
implemented in Chimera as a molecule model.
</p><p>
<a name="activeset">
Multiple marker sets can be present, but only one at a time can be 
the <b><i>active set</i></b></a>.
The <a href="#markermenu"><b>Marker set menu</b></a> shows the 
name of the active set.
Various <a href="#menu">menu</a> operations apply to the active set, and
newly created markers and links are added to this set.
</p><p>
At first, the <a href="#activeset">active</a> (and only)
marker set is <b>marker set 1</b>.
<a href="#filemenu"><b>File... New marker set</b></a>
starts a new marker set and makes it the
<a href="#activeset">active set</a>.
Marker sets are initially named <b>marker set 1</b>,
<b>marker set 2</b>, <i>etc.</i>, but can be <a href="#rename">renamed</a>.
Markers can be </b><a href="#transfer">transferred</a> from one set to another.
<a href="#filemenu"><b>File... Close marker set</b></a>
removes the <a href="#activeset">active set</a>.
A marker set cannot be recovered after it has been removed.
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="markermenu">
<b>Marker set menu</b></a>
<p>
The name of the <a href="#activeset">active set</a> is shown next to the words
<b>Marker set</b>.  Clicking on the name reveals a menu
of all open marker sets, from which a different set can be designated 
as the <a href="#activeset">active set</a>.
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="markerlist">
<b>Marker set list</b></a>
<p>
This section is a list of all open <b>Marker Sets</b>.
A set can be designated as the <a href="#activeset">active set</a>
by clicking its entry in the list.
Although only one set at a time can be the
<a href="#activeset">active set</a>,
multiple sets can be chosen from the list
by dragging with the mouse or Ctrl-clicking on individual entries.
The chosen sets can then be saved to a single 
<a href="#markerfiles">marker file</a> with
<a href="#filemenu"><b>File... Save selected marker sets as...</b></a>
or deleted with
<a href="#filemenu"><b>File... Close marker set</b></a>.
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="rename">
<b>Rename marker set</b></a>
<p>
In this section,
the <a href="#activeset">active set</a> can be renamed by entering a
new name and pressing the return key (Enter).
</p>

<a name="markers">
<h4>MARKERS</h4>
</a>
<p>
A <b><i>marker</i></b> is a sphere with an associated position, radius,
and color, implemented in Chimera as an atom.
Each marker belongs to a <a href="#setdef">marker set</a> (molecule model).
As markers are created, they are assigned successive residue numbers
for convenient 
<a href="../../UsersGuide/midas/atom_spec.html#basic">command-line 
specification</a> 
(for example, <b>#0:10-18</b> specifies markers 10-18 in model 0).
Just like other atoms in Chimera, markers can be 
<a href="../../UsersGuide/selection.html">selected</a> and their attributes
can be <a href="../../UsersGuide/inspection.html">inspected and modified</a>.
</p><p>
Markers that are <a href="../../UsersGuide/selection.html">selected</a>
can be hidden, shown, deleted, or <a href="#transfer">transferred</a> to the 
<a href="#activeset">active set</a> using the
<b>Volume Tracer</b> <a href="#actionsmenu"><b>Actions</b> menu</a>.
When no markers are selected, the hide and show (but not delete) 
<a href="#actionsmenu"><b>Actions</b></a>
apply to all markers in the <a href="#activeset">active set</a>.
A marker cannot be recovered after it has been deleted.
</p><p>
Markers that are <a href="../../UsersGuide/selection.html">selected</a> 
can also be used to define a zone of volume data display
(with <a href="../volumeviewer/volumeviewer.html#zone"><b>Zone</b></a> in
<a href="../volumeviewer/framevolumeviewer.html" target="_top"><b>Volume
Viewer</b></a>), other surface display
(with <a href="../surfzone/surfzone.html"><b>Surface Zone</b></a>),
or surface coloring 
(with <a href="../colorzone/colorzone.html"><b>Color Zone</b></a>).
</p>

<p>
<a name="creating">
A newly created marker</a> is always added to the 
<a href="#activeset">active set</a>.
When a marker is created,
it is <a href="../../UsersGuide/selection.html">selected</a>
and any other markers are deselected.
The <a href="#mousemode"><b>Mouse mode options</b></a> 
and <a href="#mousemenu"><b>Mouse</b> menu</a> control how markers are created,
while the <a href="#mousebutton"><b>Mouse button menu</b></a>
controls which mouse button is used.
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="mousebutton">
<b>Mouse button menu</b></a>
<p>
<b>Use [<i>button</i>] to place/move markers</b> controls
which mouse button will be used for marker operations.
This <b><i>assigned button</i></b>
will cease to perform any previously assigned function while
assigned to one or more marker operations in the
<a href="#mousemode"><b>Mouse mode options</b></a> 
or <a href="#mousemenu"><b>Mouse</b> menu</a>.
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="mousemode">
<b>Mouse mode options</b></a>
<p>
This section controls how markers and <a href="#links">links</a>
are created.  The checkbox options are also available
in the <a href="#mousemenu"><b>Mouse</b> menu</a>.
<ul>
<li> <a name="spotdetails"><b>Place markers on high density</b></a> 
(on by default)
- when the <a href="#mousebutton">assigned button</a> is clicked
over the <a href="../volumeviewer/volumeviewer.html#currentset">
current display region</a> of data shown with
<a href="../volumeviewer/framevolumeviewer.html" target="_top">
<b>Volume Viewer</b></a>,
add a marker at the nearest local maximum above the threshold
along the line of sight.  The marker will be placed
at the screen (X,Y) position of the cursor at the time of the mouse click, 
at the depth (Z-coordinate) of the <i>closest local maximum</i> above the 
<a href="#threshold">detection threshold</a>.
If no value along the line of sight exceeds the threshold, or if only a 
<a href="../volumeviewer/volumeviewer.html#planes">single plane</a>
of data is displayed, this option will not generate a marker.  
A <a href="#slice">slice display</a>
shows the data values along the line of sight and can be used
to adjust the threshold.
A marker cannot be placed on a data <i>minimum</i> automatically; 
it must be created first and then manually <a href="#moving">moved</a>
to a minimum.
<br><br>
<li> <a name="emptydetails"><b>Place markers on data planes</b></a> -
when the <a href="#mousebutton">assigned button</a> is clicked
over the <a href="../volumeviewer/volumeviewer.html#currentset">
current volume display region</a> or
<a href="../volumeviewer/volumeviewer.html#planes">volume plane</a>
but no marker is placed on a maximum, add a marker
halfway between the front and back of 
the <a name="boxdef"><b><i>volume data box</b></i> (the boundaries of the 
<a href="../volumeviewer/volumeviewer.html#currentset">display region</a>)
along the line of sight.
If only a <a href="../volumeviewer/volumeviewer.html#planes">plane</a> 
of data is displayed, the marker will be placed in that plane.
<br><br>
<li> <b>Place markers on surfaces</b> -
when the <a href="#mousebutton">assigned button</a> is clicked
over a <a href="../../UsersGuide/surfattrib.html#surfmodels">surface</a>,
add a marker at the nearest surface point along the line of sight
<!-- not necessarily a vertex, can be within a triangle -->
<br><br>
<li> <b>Place markers outside data</b> -
when the <a href="#mousebutton">assigned button</a> is clicked
outside the <a href="../volumeviewer/volumeviewer.html#currentset">
current volume display region</a> or when no volume data is displayed,
add a marker halfway between the near and far
<a href="../../UsersGuide/sideview.html#sideview">global clipping planes</a>.
<br><br>
<li> <a name="dragplace"><b>Place markers while dragging</b></a> -
create a stream of markers as the cursor is moved with
the <a href="#mousebutton">assigned button</a> held down.
This is primarily useful along with
<a href="#emptydetails"><b>Place markers on data planes</b></a>
for generating strings or loops of markers
for subsequent use in <a href="#surfaces">surface creation</a>.
<br><br>
<li><b>Dragging marker spacing</b> 
- how far apart to drop markers as they are created with 
<a href="#dragplace"><b>Place markers while dragging</b></a>.
The spacing is in grid units if volume data is present, otherwise
screen pixels.  A loop will be closed automatically if its start and
end markers are within this distance.
<br><br>
<li> <a name="moving"><b>Move and resize markers</b></a> 
- enable moving and resizing markers by dragging with the 
<a href="#mousebutton">assigned button</a>.  In the following, the
X axis is horizontal in the plane of the screen, Y is vertical in the plane
of the screen, and Z is orthogonal to the screen.
  <p>
  <ul>
  <li>A marker can be dragged from one (X,Y) position to another
  with the <a href="#mousebutton">assigned button</a>.
  Dragging with both the <a href="#mousebutton">assigned button</a>
  and the Shift key held down changes the Z-coordinate of the marker;
  dragging down pulls the marker closer (out of the screen)
  while dragging up pushes the marker further away (into the screen).
  The Shift key can be pressed and released repeatedly during a single
  dragging motion to switch between (X,Y) and Z-coordinate movement.
  It is difficult to see marker depth without using
  <a href="../../UsersGuide/stereo.html">stereo</a>, although the
  <a href="../../UsersGuide/sideview.html#sideview"><b>Side View</b></a>
  may be helpful.  
  Another technique is to watch for intersection of the marker with a 
  <a href="../volumeviewer/volumeviewer.html#display">volume isosurface</a> 
  as marker depth is adjusted.
  <br><br>
  <li>A marker can be resized by dragging with the
  <a href="#mousebutton">assigned button</a> when caps lock is on;
  dragging down decreases the <a href="#markerprops">radius</a>
  while dragging up increases it.
  </ul>
</p><p>
If any <a href="#creating">marker creation</a> mode is also active, the result
of clicking the <a href="#mousebutton">assigned button</a> depends on the
location of the click.  Clicking over an existing marker grabs it for
movement/resizing, while clicking elsewhere creates a new marker.
</p><p>
Only one marker can be moved or resized at a time.
A marker cannot be grabbed if there is another selectable
item (such as an atom, bond, or another marker) in front of it.
Volume displays created by
<a href="../volumeviewer/framevolumeviewer.html" target="_top">
<b>Volume Viewer</b></a> are not selectable, so they will not
interfere with marker grabbing.
</p><p>
A newly created marker can also be moved in what was the Z-dimension
at the time of its creation by dragging the vertical line in the
<a href="#slice">slice graph</a>.
</p>
<li> <a name="colormatch"><b>Marker color matches volume color</b></a>
- color new markers <a href="#spotdetails">placed on data spots</a>
to match the spots; color other new markers 
the specified <a href="#markerprops"><b>Marker color</b></a>
<br><br>
<li> <b>Link new marker to selected marker</b>
(on by default)
- as a new marker is <a href="#creating">created</a>, link it to the previously
<a href="../../UsersGuide/selection.html">selected</a> marker.
One (and only one) marker must have been selected beforehand.
<br><br>
<li> <b>Link consecutively selected markers</b>
- when an existing marker is
<a href="../../UsersGuide/selection.html">selected</a>,
link it to the previously
<a href="../../UsersGuide/selection.html">selected</a> marker.
Only one marker should be selected at a time.  
This mode allows markers <a href="#creating">created</a> previously
to be linked in any desired pattern.
</ul>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="slice">
<b>Slice display</b></a>
<p>
<table border="1" align="right" style="margin:8px 8px 8px 8px">
<tr><th><a name="slicefigure">Slice display</a></th></tr>
<tr><td><img src="slice.png"></td></tr>
</table>
A slice graph shows the data profile along the line of sight 
(the Z dimension) 
under the cursor when the <a href="#mousebutton">assigned button</a> is clicked
and marker <a href="#creating">creation</a> and/or 
<a href="#moving">movement</a> is enabled.
Near to far is shown from left to right.  
</p><p>
In the slice graph, a data set
in <a href="../volumeviewer/framevolumeviewer.html"
target="_top"><b>Volume Viewer</b></a>)
is shown with a solid line and a dotted line.
<b>Slice graph color matches volume color</b> indicates that
the lines should be shown in the same color as the volume display.
The solid line represents data values;
the dotted line is the <a href="#threshold">detection threshold</a>
for placing markers.
When a marker is <a href="#spotdetails">placed on a data spot</a>, 
its Z-position is indicated with a vertical black line,
The vertical line can be dragged to move the marker to a different depth.
This is useful when a marker has been placed on a faint foreground spot
rather than its intended destination, a brighter background spot.
</p><p>
The <a name="threshold"><b><i>detection threshold</i></b></a>
is initially the same as the lowest
<a href="../volumeviewer/volumeviewer.html#threshcolor">display threshold</a>
set in <a href="../volumeviewer/framevolumeviewer.html"
target="_top"><b>Volume Viewer</b></a>.  As needed, the
detection threshold can be dragged higher or lower in the slice graph
with the mouse.  This does not change the display threshold.
Once a detection threshold has been moved, it is shown with longer dashes.
<b>Reset</b> sets the
detection threshold(s) back to the existing display threshold(s).
</p><p>
When <b>Show slice line using color</b> is on,
creating a marker within the <a href="#boxdef">volume data box</a> generates a
line along the current Z axis that intersects the marker.
The color of the line is specified in the adjacent
<a href="../../UsersGuide/coloring.html#colorwell">color well</a>.
Changing the color will not affect an existing slice line, 
only those subsequently drawn.
If there is no volume data, no slice line will be generated.
Because the line follows the line of sight at the time of marker creation,
it will not be visible until there has been some rotation.
Upon rotation, it should be evident which data
spots the line intercepts and whether the marker has been placed
on the intended spot.  The slice line will disappear when a newer marker
is created, and if the newer marker is within the 
<a href="#boxdef">volume data box</a>,
a slice line will be drawn for the newer marker.
Slice lines are implemented as VRML models.
</p>



<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="markernotes">
<b>Marker notes</b></a>
<p>
A <b><i>marker note</i></b> is a text annotation associated with
a <a href="#markers">marker</a>, implemented as an atom label in Chimera.
Notes on markers
that are <a href="../../UsersGuide/selection.html">selected</a>
can be hidden, shown, or deleted using the
<b>Volume Tracer</b> <a href="#actionsmenu"><b>Actions</b> menu</a>.
When no markers are selected, the hide and show (but not delete) 
<a href="#actionsmenu"><b>Actions</b></a>
apply to all marker notes in the <a href="#activeset">active set</a>.
A marker note cannot be recovered after it has been deleted.
</p><p>
Entering text in the <b>Marker note</b> field and pressing the return key 
labels each <a href="../../UsersGuide/selection.html">selected</a> marker 
with that text.  Notes cannot occupy multiple lines.
The adjacent <a href="../../UsersGuide/coloring.html#colorwell">color well</a>
specifies the color of the text.
Editing the color changes the note color of any
<a href="../../UsersGuide/selection.html">selected</a> markers.
</p><p>
The font size of notes (along with all atom labels)
can be adjusted in the 
<a href="../../UsersGuide/preferences.html#Background"><b>Background</b> 
preferences</a>.  Marker notes cannot be repositioned relative to their
markers.  For publication/presentation purposes,
the <a href="../2dlabels/2dlabels.html"><b>2D Labels</b></a> tool
is a good alternative: it allows text strings of multiple sizes
and colors to be placed arbitrarily in the (X,Y) plane of the screen.
These 2D labels are not associated with any atoms or markers, and will
not move when models are rotated and translated.
</p>

<a name="links">
<h4>LINKS</h4>
</a>
<p>
A <b><i>link</i></b> is a connection between <a href="#markers">markers</a>, 
implemented in Chimera as a bond and displayed as a cylinder with 
user-specified radius and color.
Only one link can exist for a given pair of markers.
Just like other bonds in Chimera, links can be 
<a href="../../UsersGuide/selection.html">selected</a> and their attributes
can be <a href="../../UsersGuide/inspection.html">inspected and modified</a>.
</p><p>
Links that are <a href="../../UsersGuide/selection.html">selected</a>
can be hidden, shown, or deleted using the
<b>Volume Tracer</b> <a href="#actionsmenu"><b>Actions</b> menu</a>.
When no links are selected, the hide and show (but not delete) 
<a href="#actionsmenu"><b>Actions</b></a>
apply to all links in the <a href="#activeset">active set</a>.
A link will also be hidden when the markers it connects are hidden.
A link cannot be recovered after it has been deleted.
</p><p>
If the command
<a href="../../UsersGuide/midas/bondzone.html"><b>bondzone</b></a>
has been issued,
links that are <a href="../../UsersGuide/selection.html">selected</a> 
can also be used to define a zone of volume data display
(with <a href="../volumeviewer/volumeviewer.html#zone"><b>Zone</b></a> in
<a href="../volumeviewer/framevolumeviewer.html" target="_top"><b>Volume
Viewer</b></a>), other surface display
(with <a href="../surfzone/surfzone.html"><b>Surface Zone</b></a>),
or surface coloring 
(with <a href="../colorzone/colorzone.html"><b>Color Zone</b></a>).
</p><p>
A newly created link is always added to the 
<a href="#activeset">active set</a>.
When a link is created,
it is <a href="../../UsersGuide/selection.html">selected</a>
and any other links are deselected.  
The <a href="#mousemode"><b>Mouse mode options</b></a> 
and <a href="#mousemenu"><b>Mouse</b> menu</a> control how links are created.
</p>

<a name="appearance">
<h4>APPEARANCE</h4>
</a>
<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="markerprops">
<b>Marker color and radius</b></a>
<p>
This section
specifies the colors and radii of <a href="#markers">markers</a> and 
<a href="#links">links</a>.
</p><p>
Editing the <b>Marker color</b> (using the associated 
<a href="../../UsersGuide/coloring.html#colorwell">color well</a>)
changes the color of any
<a href="../../UsersGuide/selection.html">selected</a> markers.
New markers will also receive the specified <b>Marker color</b>
unless <a href="#colormatch"><b>Marker color matches volume color</b></a>
is turned on.  In that case, 
new markers <a href="#spotdetails">placed on data spots</a> will be
colored to match the spots, but other
new markers will receive the specified <b>Marker color</b>.
</p><p>
Conversely, <a href="../colorzone/colorzone.html"><b>Color Zone</b></a>
can be used to color volume data surfaces to match nearby 
<a href="../../UsersGuide/selection.html">selected</a> markers.
</p><p>
<a name="defaultrad">
When marker <b>radius</b> is not specified, a default value is
determined as follows:
</a>
<ul>
<li> When the marker is within the <a href="#boxdef">volume data box</a>
and the displayed data is not a 
<a href="../volumeviewer/volumeviewer.html#subsampledef">subsample</a>,
marker radius will be set to the X, Y, or Z grid spacing of the data,
whichever is smallest.
<li> When the marker is within the <a href="#boxdef">volume data box</a>
and the displayed data is a
<a href="../volumeviewer/volumeviewer.html#subsampledef">subsample</a>,
marker radius will be set to the X, Y, or Z grid spacing of the subsampled data,
whichever is smallest.
<li> When the first marker in a set is created outside the 
<a href="#boxdef">volume data box</a> or in the absence of any volume data, 
its radius will be set to 1/100 of the distance between the near and far 
clipping planes. The clipping plane positions can be viewed and adjusted in the
<a href="../../UsersGuide/sideview.html#sideview"><b>Side View</b></a>.
<li> When a subsequent marker (not the first in a set) is created outside the 
<a href="#boxdef">volume data box</a> or in the absence of any volume data, 
its radius will be set to equal the radius of the first marker in the set,
regardless of how that value was determined. 
</ul>
Entering a marker <b>radius</b> value (with or without
pressing the return key) sets the radii of subsequently created markers.
When the return key is pressed, the radii of
any <a href="../../UsersGuide/selection.html">selected</a> markers
will be changed accordingly.  Radii are expressed in
the physical display units, not grid index units.
Markers can also be <a href="#moving">resized with the mouse</a>.
</p><p>
The number of subdivisions used for drawing the markers
(and thus the smoothness of the spheres)
can be increased by raising <b>subdivision quality</b> in the 
<a href="../../UsersGuide/sideview.html#effects"><b>Effects</b> tool</a>.
Higher values increase smoothness, but may slow performance.
</p><p>
<a name="linkprops"></a>
Editing the <b>Link color</b> (using the associated 
<a href="../../UsersGuide/coloring.html#colorwell">color well</a>)
changes the color of any currently
<a href="../../UsersGuide/selection.html">selected</a> links
and subsequently created links.
</p><p>
Links can be shown as lines (<b>radius</b> = 0) or as cylinders
(<b>radius</b> &gt; 0).
When link <b>radius</b> is not specified, it is set to half of the
<a href="#defaultrad">default marker radius</a>.
Entering a link <b>radius</b> value (with or without pressing the
return key) sets the radii of subsequently created links.
When the return key is pressed, the radii of any
<a href="../../UsersGuide/selection.html">selected</a> links will be
changed accordingly.
</p>

<a href="#features" class="nounder"><b>&larr;</b></a>
<a name="smooth">
<b>Smooth paths</b></a>
<p>
With this section of the dialog, 
interpolated paths can be generated for
<a href="#links">linked</a> chains of <a href="#markers">markers</a>.
Clicking <b>Show</b> generates a curve for each chain of markers in the
<a href="#activeset">active set</a>;
if multiple links emanate from a marker, so will multiple curve segments.
(<a href="#links">Links</a> can be hidden with
<a href="#actionsmenu"><b>Actions... Hide links</b></a>.)
Each curve is an Overhauser (also called Catmul-Rom) spline,
a cubic spline where the tangent at each marker is parallel
to the vector between the preceding and following markers.
Curves for a marker set are implemented as
<a href="../../UsersGuide/surfattrib.html#surfpiecedef">pieces</a> of a
<a href="../../UsersGuide/surfattrib.html#surfmodels">surface model</a>.
<b>Unshow</b> removes any curves drawn for the
<a href="#activeset">active set</a>.
</p><p>
After a parameter is changed, it is necessary to click <b>Show</b> or press
return within any <b>Smooth paths</b> parameter field to apply the change.
Paths can be shown as lines (<b>Curve radius</b> = 0) or as tubes
constructed from multiple cylinders (<b>Curve radius</b> &gt; 0).
<a name="subdivisions">
The number of line segments or cylinders forming the curve between a 
linked pair of markers equals <b>Segment subdivisions</b> + 1.
</a>
</p><p>
A path is colored based on
<a href="#markerprops">marker and link colors</a>.
<b>Band length</b> specifies the length of curve
centered on each marker that should be colored the
same as the marker.  Parts of the curve further away from a marker
receive the color of the corresponding link.  Generally, color bands
are not exactly the specified length because:
<ul>
<li>Curves consist of a finite number of 
<a href="#subdivisions">subdivisions</a>.  
A change from one color to another along the curve occurs linearly
over a single line segment when <b>Curve radius</b> = 0 and
abruptly between two cylinders when <b>Curve radius</b> &gt; 0.
<li> When <b>Curve radius</b> &gt; 0, 
a path consists of cylinders joined by spheres.
Even when <b>Band length</b> = 0, there is still one joining sphere
at the position of the marker that is the same color as the marker.
How much of this sphere is visible depends on the local degree of bending.
</ul>
</p>

<a name="surfaces">
<h4>SURFACE CREATION</h4>
</a>
<a href="#features" class="nounder"><b>&larr;</b></a>
<b>Surfaces</b>
<p>
A series of connected paths (either closed loops or open curves) can be
combined to form a surface.  Typically, a path is generated for each of
several <a href="../volumeviewer/volumeviewer.html#planes">volume data 
planes</a> using the settings
<a href="#emptydetails"><b>Place markers on data planes</b></a>
and <a href="#dragplace"><b>Place markers while dragging</b></a>.
The stack of paths can then be joined in the orthogonal direction to create 
a surface.  Surfaces created by <b>Volume Tracer</b> are saved in
<a href="../../UsersGuide/sessions.html#sesdef">sessions</a> and can
be used to segment volume data with the command
<a href="../../UsersGuide/midas/mask.html"><b>mask</b></a>.
</p><p>
Clicking <b>Create</b> uses
all <a href="../../UsersGuide/selection.html">selected</a> markers,
or if none are selected, all markers in the <a href="#activeset">active set</a>,
to generate a surface.  
The markers must be linked into paths,
and the paths used to make a given surface must be 
either all closed loops or all open-ended.
Branched paths are not allowed, and the surface cannot form forked tubes.  
<b>Cap surface end loops</b> makes the surface cover
the ends of tubes formed by closed-loop paths.
</p><p>
Each surface created by <b>Volume Tracer</b> is a single
<a href="../../UsersGuide/surfattrib.html#surfpiecedef">surface piece</a>
in the <a href="../../UsersGuide/surfattrib.html#surfmodels">surface model</a>
named <b>Traced surfaces</b>.  
There is only one <b>Traced surfaces</b> model, but it can contain multiple
<a href="../../UsersGuide/surfattrib.html#surfpiecedef">surface pieces</a>
created from different collections of markers.
Clicking <b>Create</b> repeatedly for the same markers 
will generate multiple identical
<a href="../../UsersGuide/surfattrib.html#surfpiecedef">surface pieces</a>.
<b>Delete</b> closes (removes) any 
<a href="../../UsersGuide/surfattrib.html#surfpiecedef">surface pieces</a>
of the <b>Traced surfaces</b> model
that are <a href="../../UsersGuide/selection.html">selected</a>.
It is necessary to delete and recreate a surface to update it after
<a href="#moving">moving a marker</a>.
</p>

<a name="markerfiles">
<h4>MARKER FILES</h4>
</a>
<p>
A <b<i>marker file</i></b></a> includes marker set name(s), marker positions,
marker notes, links, colors, and radii (but not
<a href="#smooth">smooth paths</a> or <a href="#surfaces">surfaces</a>).
</p><p>
Marker files can be read and written using the <b>Volume Tracer</b>
<a href="#filemenu"><b>File</b> menu</a>.
In addition, they can be opened with Chimera's general file-reading
mechanisms, just like other
<a href="../../UsersGuide/filetypes.html">registered file types</a>.
The <a href="../../UsersGuide/filetypes.html#object">Chimera 
marker file type</a> can be indicated with the suffix <b>.cmm</b> (part
of the filename) or the prefix <b>markers:</b> (not part of the filename).
</p><p>
The format is actually XML, a text file that
can be viewed and edited with an editor and can be read or created by other
programs.  Libraries for parsing XML are available in many programming
languages.  The following
marker file describes two markers connected by a link:
</p>
<pre>
&lt;marker_set name="marker set 1"&gt;
&lt;marker id="1" x="-6.1267" y="17.44" z="-3.1338"  radius="0.35217"/&gt;
&lt;marker id="2" x="1.5395" y="16.277" z="-3.0339" r="0" g="1" b="1"
               radius="0.5" note="An example note"/&gt;
&lt;link id1="2" id2="1" r="1" g="1" b="0" radius="0.17609"/&gt;
&lt;/marker_set&gt;
</pre>
<p>
The <b>r</b>, <b>g</b>, and <b>b</b> attributes are red, green,
and blue color components, respectively, with possible values ranging
from 0 to 1.
</p><p>
Extra attributes can be present within the marker, link, and marker_set
tags.  While these are not used by <b>Volume Tracer</b>, they provide
a mechanism for retaining information from or passing information to 
other programs.  For example,
<pre>
&lt;marker id="3" x="3.23" y="4.34" z="5.45" r="0" g="0" b="1" radius=".4"
 note="105" somethingextra="hoola hoop"/&gt;
&lt;link id1="1" id2="2" r="0" g="1" b="0" radius=".2" leprechaun="gold"/&gt;
</pre>
shows the extra attributes somethingextra and leprechaun.
Extra attributes included in an input file are retained and included
in files written back out.
</p>

<a name="menu">
<h4>MENU LISTING</h4></a>

<a name="filemenu"><b>File</b></a>:
<ul>
<li><b>Open marker set...</b> bring up a 
<a href="../../UsersGuide/opensave.html">dialog</a>
for browsing to and opening a <a href="#markerfiles">marker file</a>
<li><b>New marker set</b> - start a new <a href="#markersets">marker set</a>
and make it the <a href="#activeset">active set</a>
<li><b>Save current marker set</b> - save the
<a href="#activeset">active set</a> to the same
<a href="#markerfiles">marker file</a> it was opened from, or if none, 
to a specified filename
<li><b>Save current marker set as...</b> 
save the <a href="#activeset">active set</a> to a 
<a href="#markerfiles">marker file</a>
<li><b>Save all marker sets as...</b> 
save all <a href="#markersets">marker sets</a> to a single
<a href="#markerfiles">marker file</a>
<li><b>Save selected marker sets as...</b> 
save all sets chosen in the <a href="#markerlist">marker set list</a> 
(or if none, the <a href="#activeset">active set</a>) to a single
<a href="#markerfiles">marker file</a>
<li><b>Close marker set</b> - delete all sets chosen in the
<a href="#markerlist">marker set list</a> 
(or if none, the <a href="#activeset">active set</a>)
</ul>

<a name="actionsmenu"><b>Actions</b></a>:
<ul>
<li><b>Show markers</b> 
- show the <a href="../../UsersGuide/selection.html">selected</a> markers,
or if none, all markers in the <a href="#activeset">active set</a>
<li><b>Hide markers</b>
- hide the <a href="../../UsersGuide/selection.html">selected</a> markers,
or if none, all markers in the <a href="#activeset">active set</a>
<li><b>Delete markers</b>
- delete the <a href="../../UsersGuide/selection.html">selected</a> markers
</ul>
<ul>
<li><b>Show links</b>
- show the <a href="../../UsersGuide/selection.html">selected</a> links,
or if none, all links in the <a href="#activeset">active set</a>
<li><b>Hide links</b>
- hide the <a href="../../UsersGuide/selection.html">selected</a> links,
or if none, all links in the <a href="#activeset">active set</a>
<li><b>Delete links</b>
- delete the <a href="../../UsersGuide/selection.html">selected</a> links
</ul>
<ul>
<li><b>Show marker notes</b>
- show annotations for 
the <a href="../../UsersGuide/selection.html">selected</a> markers,
or if no markers are selected, 
for all markers in the <a href="#activeset">active set</a>
<li><b>Hide marker notes</b>
- hide annotations for
the <a href="../../UsersGuide/selection.html">selected</a> markers,
or if no markers are selected, 
for all markers in the <a href="#activeset">active set</a>
<li><b>Delete marker notes</b>
- delete annotations for
the <a href="../../UsersGuide/selection.html">selected</a> markers
</ul>
<ul>
<li><a name="transfer"><b>Transfer selected markers to current set</b></a>
- transfer the <a href="../../UsersGuide/selection.html">selected</a> markers
to the <a href="#activeset">active set</a>; this allows markers to be
transferred from one set to another
</ul>

<a name="mousemenu"><b>Mouse</b></a> (the same settings are also in the
<a href="#mousemode"><b>Mouse mode options</b></a>):
<ul>
<li> <b>Place markers on high density</b>
(on by default)
- when the <a href="#mousebutton">assigned button</a> is clicked
over the <a href="../volumeviewer/volumeviewer.html#currentset">
current volume display region</a>,
add a marker at the nearest local maximum above the threshold
along the line of sight (<a href="#spotdetails">details...</a>)
<li> <b>Place markers on data planes</b> -
when the <a href="#mousebutton">assigned button</a> is clicked
over the <a href="../volumeviewer/volumeviewer.html#currentset">
current volume display region</a> or
<a href="../volumeviewer/volumeviewer.html#planes">volume plane</a>
but no marker is placed on a maximum, add a marker halfway between the
front and back of the <a href="#boxdef">volume data box</a> 
along the line of sight
<li> <b>Place markers on surfaces</b> -
when the <a href="#mousebutton">assigned button</a> is clicked
over a <a href="../../UsersGuide/surfattrib.html#surfmodels">surface</a>,
add a marker at the nearest surface point along the line of sight
<li> <b>Place markers outside data</b> -
when the <a href="#mousebutton">assigned button</a> is clicked
outside the <a href="../volumeviewer/volumeviewer.html#currentset">
current volume display region</a> or when no volume data is displayed,
add a marker halfway between the near and far
<a href="../../UsersGuide/sideview.html#sideview">global clipping planes</a>
<li> <b>Place markers while dragging</b> -
create a stream of markers as the cursor is moved with
the <a href="#mousebutton">assigned button</a> held down
<li> <b>Move and resize markers</b> - allow dragging
a marker with the <a href="#mousebutton">assigned button</a>,
including changing its depth when the Shift key is also held down
and changing its size when caps lock is on
<li> <b>Marker color matches volume color</b> - color new markers
<a href="#spotdetails">dropped on data spots</a>
to match the spots; color other new markers 
the specified <a href="#markerprops"><b>Marker color</b></a>
<li> <b>Link new marker to selected marker</b> 
(on by default)
- as a new marker is <a href="#creating">created</a>, link it to the previously
<a href="../../UsersGuide/selection.html">selected</a> marker
<li> <b>Link consecutively selected markers</b>
- when an existing marker is
<a href="../../UsersGuide/selection.html">selected</a>,
link it to the previously 
<a href="../../UsersGuide/selection.html">selected</a> marker
</ul>

<p>
<a href="#features"><b>Features</b>:</a>
possible sections (features) of the <b>Volume Tracer</b> dialog
</p>

<a name="limitations">
<h4>LIMITATIONS</h4>
</a>
<p><b>May place markers on data hidden with Surface Zone.</b>
Markers may be placed in regions of volume data that have been hidden with 
<a href="../surfzone/surfzone.html"><b>Surface Zone</b></a>.
Markers land at the same locations they would if no surface zone were
in effect, possibly in volume regions outside of the displayed zone.
</p>
<p><b>Transparency not saved.</b>
Although markers and links can be transparent (when transparent 
<a href="#markerprops">marker and link colors</a> are used),
transparency is not saved in <a href="#markerfiles">marker files</a>. 

<a name="plans">
<h4>POSSIBLE DEVELOPMENTS</h4>
</a>
<ul>
<li>enable automatic marker creation/placement on minima
<li>add option to center markers on local maxima or minima in 3D
<li>add option to determine link colors from marker color (atom halfbond)
<li>optimize slice graph display so that marker placement is not slow
<li>allow definition of different groups of markers within a single marker set
<li>supply Python code for reading and writing the XML files containing
 saved marker sets
<li>make tubes using triangle lists for better resolution control and efficiency
<li>set curve radius automatically based on marker and/or link radius
<li>redraw curves automatically when curve parameters are changed
<li>allow curves to have a uniform color even when not all markers/links
 are the same color
</ul>

<hr>
<address>UCSF Computer Graphics Laboratory / August 2009</address>
</body></html>
