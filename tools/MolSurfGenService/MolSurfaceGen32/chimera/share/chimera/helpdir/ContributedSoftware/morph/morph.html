<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2006-2009 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Morph Conformations</TITLE>
</head>
<body>
<h3>Morph Conformations 
<img src="morphicon.png" alt="Morph Conformations icon"></h3>

<a name="figure"></a>
<table align="right" style="margin:8px 8px 8px 8px">
<tr><th>GTP-binding switch</th></tr>
<tr><td align="center">
(<font color="#3333CC"><b>1tagA</b></font>, 
<font color="#CC0066"><b>1tndA</b></font>, 
<font color="#666699">morph intermediate</font>)
</td></tr><tr><td>
<img src="transducin.png" alt="transducin morph">
</td></tr>
</table

<p>
<b>Morph Conformations</b> creates a trajectory that morphs
between two or more structures.
A few <a href="#examples">example systems</a> are listed below.
<a href="../movie/framemovie.html" target="_top"><b>MD Movie</b></a>
is automatically used to show the trajectory and can
<a href="../movie/movie.html#recording">record</a> it as a movie.
See also: 
<a href="../../UsersGuide/midas/coordset.html"><b>coordset</b></a>,
<a href="../../UsersGuide/movies.html">making movies</a>
</p><p>
<b>Morph Conformations</b> is under development
(see <a href="#limitations">limitations</a>).
</p><p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>Morph Conformations</b>, a tool in the <b>Structure Comparison</b> category.
It is also implemented as the command
<a href="../../UsersGuide/midas/morph.html"><b>morph</b></a>.
</p><p>
The different structures should be opened as separate models or submodels 
in Chimera and <a href="../../UsersGuide/superposition.html">superimposed</a>.
The apparent motion across a morph trajectory depends on how the input
structures are superimposed; matched regions will remain approximately steady.
The structures can have different numbers of residues or different 
sequences (homologs or mutants can be compared), but currently
they must contain <a href="#equalchains">equal numbers of chains</a>.
</p><p>
The next step is to populate the <b>Conformations</b> list</a>
with structures; the order in the list corresponds to the order in which 
they will be visited in the output trajectory.  
The same model can be listed more than once to produce a morph trajectory 
that visits the same conformation more than once, for example:
A &rarr; B &rarr; C &rarr; A.
</p><p>
<a name="addmodels">
Clicking <b>Add...</b> brings up a dialog that lists the open molecule models.  
</a>
Clicking a model's name and then the <b>Add</b> button (or double-clicking
the model's name) puts it in the <b>Conformations</b> list. 
Multiple models can be chosen and added simultaneously.
A block of models can be chosen by dragging, or by
clicking on the first (or last) line in the desired block
and then <b>Shift</b>-clicking on its last (or first) line.
<b>Ctrl</b>-click toggles the state (chosen or not) of single line.
After the desired conformations have been added, the model-choosing dialog
can be dismissed by clicking <b>Close</b>.
</p><p>
Clicking a line in the <b>Conformations</b> list designates that entry
as the target of subsequent button actions:
<ul>
<li><b>Remove</b> - remove the conformation
<li><b>Up</b> - move the conformation higher in the list 
(earlier in the trajectory)
<li><b>Down</b> - move the conformation lower in the list
(later in the trajectory)
</ul>
<a name="segdef">
Each sequential pair of structures in the <b>Conformations</b> list
will serve as the starting and ending points of one <b><i>segment</i></b></a>
of a morph trajectory.  A morph trajectory can have multiple segments.
Within each segment, <a name="intermediate"><b><i>intermediates</i></b></a> 
are generated by interpolating the positions of the 
<a href="#pairing">atoms in common</a>.  Interpolation includes:
<ol>
<li><a name="rigid">rigid-body transformations of atom groups</a>
partitioned by hinge regions.  Hinges are identified as described in
<a href="http://www.ncbi.nlm.nih.gov/pubmed/10734184" target="_blank">Krebs 
and Gerstein</a>, <i>Nucleic Acids Res</i> <b>28</b>:1665 (2000).
<li><a name="flexible">coordinate changes within the atom groups</a>
</ol>
How interpolated coordinates are generated, and in how many steps,
can be specified independently for each <a href="#segdef">segment</a>. 
The following four settings apply to the segment preceding the structure 
currently highlighted in the <b>Conformations</b> list.
<ul>
<li><b>Interpolation method</b>
- how the <a href="#rigid">rigid-body transformations</a> will be calculated
  <ul>
  <li> <b>corkscrew</b> (default) 
  - Each group's starting and ending positions are related
  by a rotation about a center chosen to describe as much of the movement 
  as possible, and a translation along the axis of rotation.
  These two components are interpolated.
  <li> <b>independent</b>
  - Each group's starting and ending positions are related 
  by a rotation about the group's center of mass, and a translation.  
  These two components are interpolated.
  <li> <b>linear</b>
  - Each group's starting and ending positions are related by a translation,
  which is interpolated.
  </ul>
<li><b>Interpolation rate</b>
- how conformational changes will be distributed 
across the <a href="#segdef">segment</a>
  <ul>
  <li> <b>linear</b> (default) 
  - coordinate changes will be distributed approximately evenly 
  <li> <b>ramp down</b> 
  - coordinates will change most rapidly near the starting conformation
  <li> <b>ramp up</b> 
  - coordinates will change most rapidly near the ending conformation
  <li> <b>sinusoidal</b> - coordinates will change most rapidly halfway
  between the starting and ending conformations
  </ul>
<li><b>Interpolation steps [<i>K</i>]</b>
  - the starting and ending conformations of the <a href="#segdef">segment</a>
  will be <i>K</i> steps apart (default <b>20</b>); <i>K</i>&ndash;1 
  <a href="#intermediate">intermediates</a> will be generated 
<li><b>Force Cartesian intermediates</b> (off by default) - whether 
<a href="#flexible">within-group coordinate changes</a>
should be interpolated strictly in Cartesian space.  
Otherwise, internal coordinates will be used for the
interpolation where possible.  Using internal coordinates is slower
but produces less distortion.  A trajectory made with Cartesian forcing
may be acceptable if few atomic details will be shown (for example,
if only ribbons will be displayed).
</ul>
The <b>Minimize</b> setting applies collectively
to all <a href="#segdef">segments</a> of the morph trajectory:
<ul>
<li><a name="minsteps"><b>Minimization steps [<i>N</i>]</b></a>
- <i>N</i> steps of minimization (default <b>60</b>)
will be applied to each <a href="#intermediate">intermediate</a>
<p>
Minimization requires the correction of structural inconsistencies, 
addition of hydrogens, and association of atoms with 
<a href="../minimize/minimize.html#parameters">force field parameters</a>.
<a href="../dockprep/dockprep.html"><b>Dock Prep</b></a>,
<a href="../addh/addh.html"><b>AddH</b></a>,
<a href="../addcharge/addcharge.html"><b>Add Charge</b></a>, and
<a href="../minimize/minimize.html"><b>Minimize Structure</b></a>
are called in no-GUI mode to perform these tasks; that is,
the dialogs will not appear, but each tool will execute with default 
settings.  When minimization is turned on, interpolation
to generate an <a href="#intermediate">intermediate</a>
will use the minimized coordinates of the prior intermediate.
</ul>
Clicking <b>Create</b> hides the dialog 
(unless the option to <b>Keep dialog up after Create</b> is checked)
and initiates the calculation.
The <a href="../movie/framemovie.html" target="_top"><b>MD Movie</b></a> tool
will be called to display the morph trajectory, 
and any specified <b>Action on Create</b> will be performed:
  <ul>
  <li><b>none</b>
  <li><b>show Model Panel</b> - open the 
  <a href="../../UsersGuide/modelpanel.html"><b>Model Panel</b></a>
  (allowing the input structures to be hidden or closed)
  <li><b>hide Conformations</b> - hide the input structures 
  </ul>
The trajectory will be opened as a separate model.  Coordinates for the
<a href="#pairing">atoms in common</a> from the <a href="#segdef">segment</a> 
endpoints (input structures) and the <a href="#intermediate">intermediates</a> 
comprise the frames of the trajectory.
The <a href="../movie/framemovie.html" target="_top"><b>MD Movie</b></a> tool
can be used to <a href="../movie/movie.html#recording">record</a> 
the trajectory as a movie file.
If the movie includes ribbons, consider re-evaluating secondary structure
at each frame as described <a href="#ksdssp">below</a>.
After the trajectory has been viewed, it can be
<a href="../../UsersGuide/savemodel.html#pdb">saved as a PDB file</a>.
</p><p>
<b>Hide</b> hides the <b>Morph Conformations</b> dialog, <b>Quit</b> exits 
from the tool, and <b>Help</b> opens this manual page in a browser window.
If the <b>Morph Conformations</b> dialog has been hidden or
becomes obscured by other windows, it can be resurrected with the
<b>Raise</b> option for its 
<a href="../../UsersGuide/instances.html">instance in the
<b>Tools</b> menu</a>.
Multiple copies of the <b>Morph Conformations</b> dialog can coexist, 
possibly with different settings and/or listed conformations.
</p>

<a name="pairing">
<h3>Atoms in Common</h3></a>
<p> 
<a href="#intermediate">Intermediates</a> are generated by
interpolating between starting and ending structures.
Interpolation requires a pairing of atoms in the starting structure 
with atoms in the ending structure.
Only atoms common to both <a href="#segdef">segment</a> endpoints
are included in the morph trajectory.
</p><p>
Residues are paired by aligning the sequences of their chains.  
The sequence alignment is performed using the 
<a href="../../UsersGuide/midas/mmaker.html"><b>matchmaker</b></a> defaults
(Needleman-Wunsch algorithm, BLOSUM-62 matrix, secondary structure reassignment
with <a href="../../UsersGuide/midas/ksdssp.html"><b>ksdssp</b></a>, 
30% secondary structure scoring, <i>etc.</i>),
except that the Nucleic matrix is used for nucleic acids.
Only the sequence alignment stage of
<a href="../../UsersGuide/midas/mmaker.html"><b>matchmaker</b></a> is
performed, not the superposition of structures.  
<b>Morph Conformations</b> does not change how the input structures are 
superimposed.
</p><p>
Once residues are paired, atoms in common within those residues are paired.  
In paired residues of the same type, atom pairing is straightforward.
In paired residues of different types, only atoms with the same names
are paired, and only a single connected fragment is kept per residue.
For example (disregarding hydrogens),
phenylalanine and tyrosine have in common all atoms of phenylalanine.
</p>

<a name="examples">
<h3>Example Systems for Morphing</h3></a>
<p>
A few example systems are listed here, including chain IDs.  Currently
it is necessary to delete other peptide chains before morphing
between the structures.
</p><p>
Different conformations of the same or nearly the same protein:
 <ul>
 <li>alpha-transducin GTP-binding switch
(see the <a href="#figure">figure</a> and the 
<a href="../../UsersGuide/tutorials/alignments.html#sameprot">Superpositions 
and Alignments tutorial</a>): 
  <ul>
  <li>1tagA - complex with GDP
  <li>1tndA - complex with GTP analog
  </ul>
 <li>thioredoxin reductase ball-and-socket movement:
  <ul>
  <li>1tdeA - complex with FAD
  <li>1f6mA - complex with FAD and NADP+ analog
  </ul>
<li>glucose/galactose binding protein:
  <ul>
  <li>2fw0A - uncomplexed
  <li>2gbpA - complex with glucose
  </ul>
 </ul>
Different but homologous proteins:
 <ul>
 <li>phosphomannomutases, pairwise sequence identity ~50-70%: 
  <ul>
  <li>2i55C - <i>Leishmania</i> PMM complex with glucose bisphosphate
  <li>2fucA - human PMM1
  <li>2amyA - human PMM2
  </ul>
 <li>pectate lyases from different organisms, sequence identity ~35%: 
  <ul>
  <li>1jtaA
  <li> 1bn8A
  </ul>
 </ul>
As structures become less similar in sequence, a morph trajectory 
between them is more likely to contain backbone "breaks,"
corresponding to gaps in the sequence alignment that defines the
<a href="#pairing">atoms in common</a>.
</p>

<a name="limitations">
<h3>Limitations</h3></a>

<p> 
<a name="ksdssp">
<b>MD Movie does not automatically re-evaluate secondary structure</b>.</a>
<a href="../movie/framemovie.html" target="_top"><b>MD Movie</b></a>
does not automatically recompute secondary structure assignments as 
coordinates change across a trajectory.  This is relevant when 
<a href="../../UsersGuide/representation.html#ribbon">ribbons</a>
are displayed and the conformational changes are large enough to alter 
secondary structure assignments.
To recompute secondary structure at each frame,
use a <a href="../movie/movie.html#per-frame">per-frame script</a> in
<a href="../movie/framemovie.html" target="_top"><b>MD Movie</b></a>
that includes the Chimera command 
<a href="../../UsersGuide/midas/ksdssp.html"><b>ksdssp</b></a>.
</p>
<p> 
<a name="equalchains">
<b>Structures with different numbers of chains are not handled</b>.</a>
Currently, a morph trajectory can only be generated from input structures 
with equal numbers of biopolymer chains.
Extra chains in the input models should be 
<a href="../../UsersGuide/midas/delete.html">deleted</a> beforehand
or <a href="../../UsersGuide/midas/split.html">split</a>
into separate models not used in morphing.
</p>
<p> 
<b>Sequences should be easy to align</b>.
The sequences of the structures must be
aligned to determine the <a href="#pairing">atoms in common</a>
for interpolation.  When the sequences are dissimilar, 
parts of the sequence alignment may be wrong, leading to a jumbled
and unattractive morph trajectory.  A possible future improvement is 
to allow users to specify residue pairings with an input sequence alignment.
</p>
<p> 
<b>Minimization limitations</b>.  
The <a href="../minimize/minimize.html"><b>Minimize Structure</b></a> tool
has its own set of 
<a href="../minimize/minimize.html#limitations">limitations</a>.
</p>

<hr>
<address>UCSF Computer Graphics Laboratory / May 2009</address>
</body>
</html>
