<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2005 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Attribute Calculator</TITLE>
</head>
<body>
<h3>Attribute Calculator <img src="attrcalcicon.png" 
alt="Attribute Calculator icon"></h3>

<p>
<b>Attribute Calculator</b> generates new numerical
<a href="../defineattrib/defineattrib.html#attribdef">attributes</a>
from existing ones.
The calculated attribute values, or even simply the values of an
existing attribute, can be written to a file.
</p><p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>Attribute Calculator</b>, a tool in the <b>Structure Analysis</b> category.
</p><p>
One must specify a name for the attribute to be created and whether it will 
be an attribute of <b>atoms</b>, <b>residues</b>, or molecule <b>models</b>.
The name must be an alphanumeric string without spaces; it can include 
underscores, but should not begin with a underscore, digit, or capital letter.
</p><p>
The <a name="formula"><b>Formula</b></a>
is an arithmetic expression.  Supported operators are
<b>+</b> (addition), <b>&ndash;</b> (subtraction), <b>*</b> (multiplication),
and <b>/</b> (division).  Parentheses can be used for grouping.
</p>
Terms in the expression can be:
<ul>
<li> <b>numbers</b> - simple integers and floating-point numbers only, 
<i>i.e.</i>, no scientific notation
<li> <b>function calls</b> -  currently, only the functions 
<b>sum</b> and <b>average</b> are supported.  Averages are calculated
considering only the atoms (or residues) with values for the attribute.
For example, the average 
<a href="../../UsersGuide/midas/hydrophob.html"><b>kdHydrophobicity</b></a> 
of a model containing amino acid and water residues is calculated 
considering only the amino acid residues.
<li> <b>attributes</b> - attributes are of the form 
<b><i>scope.attribute</i></b>.
The <b><i>scope</i></b> can be <b>atom</b>, <b>residue</b>,
or <b>molecule</b>, and <b><i>attribute</i></b> is the name of a 
numerical attribute of the appropriate scope 
(for example, see the lists of attributes automatically defined for
<a href="../../UsersGuide/midas/atom_spec.html#atprops">atoms</a>,
<a href="../../UsersGuide/midas/atom_spec.html#resprops">residues</a>, and 
<a href="../../UsersGuide/midas/atom_spec.html#modprops">molecule models</a>).
When defining a larger scope and referring to values from a smaller scope, 
the attribute is actually a list of values.  Typically, the value
list must be reduced to scalar using a function.  
<p>
For example, to define a residue (or molecule model) attribute 
equal to the average B-factor of its constituent atoms:
<blockquote><code>
average(atom.bfactor)
</blockquote></code>
</p>
</ul>
Several options further affect the calculation and attribute assignment:
<ul>
<li> <b>Restrict attribute assignment to current selection, if any</b>
- whether, if a <a href="../../UsersGuide/selection.html">selection</a> exists,
to assign values of the new attribute to the selected items
(atoms, residues, or molecule models) only
<li> <b>Restrict formula domain to current selection, if any</b>
- whether, if a <a href="../../UsersGuide/selection.html">selection</a> exists,
only the attribute values of selected items should be used in the calculation
<li> <b>Open Render/Select by Attribute</b>
- whether to open the
<a href="../render/render.html"><b>Render/Select by Attribute</b></a> tool
after assigning attribute values.  Even when this option is off,
the attribute(s) will be available within the
<A href="../render/render.html"><b>Render/Select
by Attribute</b></a> tool if it is opened later in the session.
<li> <b>Show calculation results in Reply Log</b>
- whether to report results in the <a href="../../UsersGuide/reply.html">
<b>Reply Log</b></a>
<li> <b>Save calculation results to file</b> - whether to write
the results to a text file, in the 
<a href="../defineattrib/defineattrib.html#attrfile">format</a>
used as input to
<a href="../defineattrib/defineattrib.html"><b>Define Attribute</b></a>
</ul>
</p><p>
<b>OK</b> performs the calculation/assignment and dismisses the dialog.
<b>Apply</b> performs the calculation/assignment without dismissing the dialog.
<b>Close</b> dismisses the dialog, and
<b>Help</b> opens this manual page in a browser window.
</p><p>
The <a href="#formula">formula</a> is not reevaluated automatically;
if any constituent attribute values change,
<b>OK</b> or <b>Apply</b> must be used again
to recalculate the result with the new values.
</p>
<hr>
<address>UCSF Computer Graphics Laboratory / April 2005</address>
</body></html>
