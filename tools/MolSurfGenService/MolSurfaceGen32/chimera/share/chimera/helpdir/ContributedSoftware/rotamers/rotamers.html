<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2007-2009 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Rotamers</TITLE>
</head>
<body>

<h3>Rotamers <img src="rotamers-icon.png" alt="Rotamers icon"></h3>

<table border="1" align="right" style="margin:8px 8px 8px 8px"> 
<tr><th><a name="rotfig">rotamers at 1z6m His80</a>
(see <a href="#listfig">list</a>)</th></tr>
<tr><td><img src="1z6m-rot.png"></td></tr>
</table>
<p>
The <b>Rotamers</b> tool allows amino acid sidechain rotamers to be viewed,
<a href="#evaluation">evaluated</a>, and 
<a href="#incorporation">incorporated</a> into structures.  
A residue can be changed into a different rotamer of the same type
of amino acid or mutated into a different type.
The state of <b>Rotamers</b> is included in saved
<a href="../../UsersGuide/sessions.html#sesdef">sessions</a>.
See also: 
<a href="../structuremeas/structuremeas.html#adjust"><b>Adjust
Torsions</b></a>,
<a href="../dockprep/dockprep.html"><b>Dock Prep</b></a>
</p><p>
Although multiple sidechains in a structure can be replaced, 
<b>Rotamers</b> is not recommended for predicting the conformations of
multiple sidechains in an interacting cluster.  Programs such as
<a href="http://dunbrack.fccc.edu/scwrl/" target="_blank">SCWRL</a>
are more appropriate for that purpose.
</p><p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>Rotamers</b>, a tool in the <b>Structure Editing</b> category.
<b>Rotamers</b> is also implemented as the command
<a href="../../UsersGuide/midas/swapaa.html"><b>swapaa</b></a>.
</p><p>
One or more amino acid residues must be
<a href="../../UsersGuide/selection.html">selected</a> 
to indicate where the rotamers should be placed.
Partly selected residues will be considered selected, and if more than
one residue is selected, a rotamer set (of the same residue type)
will be placed at each.
<ul>
<li><b>Rotamer type</b> (choices are the 20 standard amino acids)
- residue type of the rotamers to be shown at each
<a href="../../UsersGuide/selection.html">selected</a> position
<li><a name="library"><b>Rotamer library</b></a>
- source of rotamer torsion values and probabilities
  <ul>
  <li><b>Dunbrack</b> - <a href="http://dunbrack.fccc.edu/bbdep/"
target="_blank">Dunbrack backbone-dependent rotamer library</a>
(for chain-terminal residues, the Dunbrack backbone-independent version is used instead):
   <blockquote>
<a href="http://www.ncbi.nlm.nih.gov/pubmed/12163064" target="_blank">
Rotamer libraries in the 21st century.</a>
Dunbrack RL Jr.
<i>Curr Opin Struct Biol.</i> 2002 Aug;12(4):431-40.
   </blockquote>
 <li><b>Richardson (common-atom)</b> - common-atom values (author-recommended) 
from the <a href="http://kinemage.biochem.duke.edu/databases/rotamer.php#PRL"
target="_blank">Richardson backbone-independent rotamer library</a>:
   <blockquote>
<a href="http://www.ncbi.nlm.nih.gov/pubmed/10861930" target="_blank">
The penultimate rotamer library.</a>
Lovell SC, Word JM, Richardson JS, Richardson DC.
<i>Proteins.</i> 2000 Aug 15;40(3):389-408.
   </blockquote>
 <li><b>Richardson (mode)</b> - mode values from the
<a href="http://kinemage.biochem.duke.edu/databases/rotamer.php#PRL"
target="_blank">Richardson backbone-independent rotamer library</a>
 </ul>
</ul>
<b>Close</b> dismisses the <b>Rotamers</b> dialog, while <b>Help</b>
opens this manual page in a browser window.
</p><p>
When <b>Apply</b> (or <b>OK</b>, which also dismisses the dialog) 
is clicked, phi and psi angles at each
<a href="../../UsersGuide/selection.html">selected</a> position are measured
and reported in the <a href="../../UsersGuide/reply.html"><b>Reply Log</b></a>.
If a type without a rotamer set (glycine, alanine) has been specified, the
residue(s) will simply be changed to the new type, 
and the change cannot be undone.
Otherwise, for each 
<a href="../../UsersGuide/selection.html">selected</a> position,
the specified rotamer set will be displayed and a 
<a href="#rotamerlist">rotamer list</a> will appear.
Bond lengths and angles are taken from the
<a href="http://ambermd.org/index.html" target="_blank"><b>Amber</b></a>
parameter files <b>all*94.lib</b>, and hydrogens are not included.
</p>

<a name="rotamerlist">
<h4>ROTAMER LISTS</h4></a>

<table border="1" align="right" style="margin:8px 8px 8px 8px"> 
<tr><th><a name="listfig">rotamer list</a>
(see <a href="#rotfig">display</a>)</th></tr>
<tr><td><img src="rotlist.png" alt="rotamer list"></td></tr>
</table>
<p>
Each rotamer list includes sidechain torsion (<b>Chi</b>) and 
<b>Probability</b> values.  Probabilities are simply taken from the 
<a href="#library">rotamer library</a> and are not
affected by the structural environment, 
except by phi and psi angles when the Dunbrack library is used.
Rotamers are initially listed in order of decreasing probability, but
the listing can be sorted by the values in any column by clicking
the header. Clicking the header once sorts the entries in 
order of increasing value and places an up arrowhead in the header. 
Clicking again sorts the entries in decreasing order and places a 
down arrowhead in the header.
</p><p>
The rotamer-list
<a href="#colmenu"><b>Columns</b> menu</a> controls which columns are shown
and allows rotamers to be <a href="#evaluation">evaluated</a> in terms of
clashes or contacts, hydrogen bonds, and/or overlap with a density map. 
The rotamer-list <a href="#selmenu"><b>Select</b> menu</a> allows
rotamers to be <a href="../../UsersGuide/selection.html">selected</a>
for subsequent operations such as with the
<a href="../../UsersGuide/menu.html#menuactions"><b>Actions</b> menu</a> or
<a href="../../UsersGuide/framecommand.html" target="_top">commands</a>.
</p><p>
<a name="chosen">
One or more rotamers can be <b><i>chosen</b></i> from the list</a>
by clicking and dragging with the left mouse button;
<b>Ctrl</b>-click toggles whether a rotamer is chosen.
Only the chosen rotamers are displayed.
</p><p>
<a name="incorporation">
Clicking <b>Apply</b> (or <b>OK</b>, which also dismisses the list) 
replaces the current sidechain with the the <a href="#chosen">chosen</a>
rotamer(s).</a>  After the former sidechain has been replaced, 
it cannot be recovered except by reopening the structure.
If multiple rotamers are incorporated at the same position, they will be
assigned different alternate location identifiers.
The <a href="../../UsersGuide/representation.html">display style</a>
of the former sidechain will be used. Other
characteristics, however, will not be transferred and may need to be
regenerated (for example, with 
<a href="../addh/addh.html"><b>AddH</b></a> and
<a href="../addcharge/addcharge.html"><b>Add Charge</b></a>).
<b>Close</b> dismisses the list and deletes the set of rotamers
without further modifying the structure.
</p>

<a name="evaluation">
<h4>ROTAMER EVALUATION</h4></a>
<p>
Rotamers can be evaluated in the context of the structural environment or
<a href="#density">compared to density</a> (or other
<a href="../../UsersGuide/filetypes.html#volume">volume data</a>).
Only the sidechain atoms of a rotamer are evaluated.  For
<a href="#hbonds">hydrogen bond</a> and <a href="#clashes">clash</a> detection,
interactions with rotamers in the same set and the current residue at that 
position are disregarded, but all other atoms in the vicinity will be included 
unless <b>Ignore... other models</b> (see below) is used.
That setting is useful for preventing superimposed related proteins
or additional copies of the starting structure from contributing to the counts.
In addition, atoms in the same model that are unwanted
for such calculations (for example, 
<a href="../../UsersGuide/midas/surface.html#surfcats">solvent</a>)
should be deleted beforehand.  
</p><p>
<a name="clashes">
<a href="#colmenu"><b>Columns...  Add... Clashes</b></a>
brings up a dialog for finding clashes or contacts</a>
and showing the results in the <a href="#rotamerlist">rotamer list</a>.  
This uses capabilities from 
<a href="../findclash/findclash.html"><b>Find Clashes/Contacts</b></a>:
<ul>
<a name="cutoff">
<li><b>Find atoms with VDW overlap >=[ <i>cutoff</i> ] angstroms</b></a>
(default <b>0.6</b> &Aring;)
<li><b>Subtract [ <i>allowance</i> ] 
from overlap for potentially H-bonding pairs</b>
(default <b>0.4</b> &Aring;)
</ul>
<blockquote>
The <a name="overlap"><b><i>overlap</i></b></a>
between two atoms is defined as the sum of their 
<a href="../../UsersGuide/midas/vdwrad.html">VDW radii</a> minus the 
distance between them and minus an allowance
for potentially hydrogen-bonded pairs:
  <blockquote>
  <i>overlap<sub>ij</sub></i> = 
  r<sub>VDW<i>i</i></sub> + r<sub>VDW<i>j</i></sub> 
  &ndash; d<sub>ij</sub> &ndash; <i>allowance<sub>ij</sub></i>
  </blockquote>
An <i>allowance</i> &gt; 0
reflects the observation that atoms sharing a hydrogen bond can come
closer to each other than would be expected from their
<a href="../../UsersGuide/midas/vdwrad.html">VDW radii</a>.
It is only subtracted for pairs comprised of a possible hydrogen-bond 
donor atom (or donor-borne hydrogen) and possible acceptor atom.
</p><p>
The <b>Default criteria</b> are appropriate for clash detection.
For detecting <b><i>clashes</i></b>,</a>
<i>cutoff</i> values of 0.4-1.0 &Aring; 
and <i>allowance</i> values of 0.2-0.6 &Aring; are 
generally reasonable.
For detecting <b><i>contacts</i></b>, negative <i>cutoff</i> values
of 0.0-(&ndash;1.0) &Aring;
with an <i>allowance</i> of 0.0 &Aring; are generally reasonable.
</blockquote>
<ul>
<li><b>Column Value</b> - what to show in the <b>Clashes</b> column
of the <a href="#rotamerlist">rotamer list</a>
  <ul>
  <li><b>Number of clashes</b> (default) 
  - how many interactions with <a href="#overlap"><i>overlap</i></a> 
  &ge; <a href="#cutoff"><i>cutoff</i></a> are found for the rotamer
  <li><b>Sum of overlaps</b> 
  - the sum of rotamer <a href="#overlap"><i>overlap</i></a> values
  &ge; <a href="#cutoff"><i>cutoff</i></a>
  </ul>
<li><b>Draw pseudobonds of color</b>
[ <a href="../../UsersGuide/coloring.html#colorwell">color well</a> ]
<b>and width</b> [ <i>linewidth</i> ]
- whether to show the interactions as
  <a href="../../UsersGuide/pbpanel.html#pbdef">pseudobonds</a> of the 
  specified color and linewidth
<li><b>Ignore clashes with other models</b>
- whether to count only interactions with the model 
for which the rotamer set is shown
</ul>
<a name="hbonds">
<a href="#colmenu"><b>Columns...  Add... H-Bonds</b></a>
brings up a dialog for finding hydrogen bonds (H-bonds)</a>
and showing the results in the <a href="#rotamerlist">rotamer list</a>.  
This uses capabilities from
<a href="../findhbond/findhbond.html"><b>FindHBond</b></a>:
<ul>
<li><b>Draw H-bonds of color</b>
[ <a href="../../UsersGuide/coloring.html#colorwell">color well</a> ]
<b>and width</b> [ <i>linewidth</i> ]
- whether to show the H-bonds as
  <a href="../../UsersGuide/pbpanel.html#pbdef">pseudobonds</a>
  of the specified color and linewidth
<li><b>Relax H-bond constraints</b> (<b>on</b> by default)
- whether the tolerances to <b>Relax constraints by</b> 
(default <b>0.4</b> &Aring; and <b>20.0</b> degrees) 
should be applied to the precise
<a href="../findhbond/findhbond.html#criteria">geometric criteria</a>
for hydrogen bonding
<li><b>Color H-bonds not meeting precise criteria differently</b>
[ <a href="../../UsersGuide/coloring.html#colorwell">color well</a> ]
- whether to use the specified color for H-bonds meeting the
relaxed but not the precise
<a href="../findhbond/findhbond.html#criteria">geometric criteria</a>
<li><b>Ignore H-bonds with other models</b>
- whether to count only interactions with the model 
for which the rotamer set is shown
</ul>
<a name="density">
<a href="#colmenu"><b>Columns...  Add... Density</b></a>
brings up a dialog for comparing rotamer sidechain atoms with
a density map</a> (or other
<a href="../../UsersGuide/filetypes.html#volume">volume data</a>)
and showing the results in the <a href="#rotamerlist">rotamer list</a>.
The <b>Volume data</b> should be chosen from the list of open volume data sets.
<b>Browse...</b> can be used to locate and open a volume data file if it
is not already open.  Map values at the rotamer sidechain atom positions
(see <a href="../density/density.html"><b>Values at Atom Positions</b></a>)
will be summed and shown using the specified <b>Column name</b>.
</p><p>
Clicking <b>Apply</b> (or <b>OK</b>, which also dismisses the dialog) 
performs the calculation and shows the results
in the <a href="#rotamerlist">rotamer list</a>.
<b>Close</b> simply dismisses the dialog, while <b>Help</b> opens this
manual page in a browser window.
</p>

<a name="menu">
<h4>ROTAMER LIST MENU</h4>
</a>
<a name="selmenu"><h4>Select</h4></a>
<ul>
<li><b>Current Rotamers</b> 
- <a href="../../UsersGuide/selection.html">select</a> all rotamers
currently <a href="#chosen">chosen</a> in the 
<a href="#rotamerlist">rotamer list</a>
<li><b>All Rotamers</b>
- <a href="../../UsersGuide/selection.html">select</a> all rotamers in the
<a href="#rotamerlist">rotamer list</a>
</ul>
<a name="colmenu"><h4>Columns</h4></a>
<ul>
<li><b>Add</b>
  <ul>
  <li><b>Clashes...</b> <a href="#evaluation">evaluate</a>
  rotamer <a href="#clashes">clashes/contacts</a>
  and show the results in a <b>Clashes</b> column
  <li><b>H-Bonds...</b> <a href="#evaluation">evaluate</a>
  rotamer <a href="#hbonds">H-bonds</a>
  and show the results in an <b>H-Bonds</b> column
  <li><b>Density...</b> <a href="#evaluation">evaluate</a>
  rotamer <a href="#density">fit with density<a/> or other
  <a href="../../UsersGuide/filetypes.html#volume">volume data</a>
  and show the results in a column
  </ul>
</ul><ul>
<li>[<b><i>currently available columns</i></b>] 
- show/hide column according to checkbox
</ul>
<hr>
<address>UCSF Computer Graphics Laboratory / August 2009</address>
</body>
</html>
